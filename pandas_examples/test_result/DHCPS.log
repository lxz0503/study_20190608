ANVL version 8.80.1.28 (Linux). Copyright (c) (2020) Ixia.  All Rights reserved.
ANVL Machine info: 2.6.18-348.el5PAE
                   Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz
                   Total Memory 8197464 kB RAM. Free Memory 6041256 kB RAM.
                   025650-678a76-daddf8-a95c
ANVL command line: /opt/Ixia/IxANVL880/ANVL-SRC/Bin/ix86-Linux/anvl -l low -f /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvldhcpserver dhcp-server 1-2.6 4.1-5.5 6.1 6.3 6.4 7.1-10.1 10.3-10.5 10.7-10.11 10.14-10.18 11.2 12.2-12.5 12.7 12.9 12.11 12.13 13.1-13.4 14.1 15.2 16.1-16.3 


# Parameter File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvldhcpserver.prm 

Reboot Time                              300                 # (0x0000012C)
Reboot Command                           ""
Post suite Command                       "./DocScriptQ35/DHCP-SERVER/DHCPSpostsuite.exp $ANVL_DUTHOSTNAME"
DUT Verification Returns FALSE on Success False
DUT Verification Return Value on Success 1                   # (0x00000001)
DUT Configure Check Return Value         False
IP DUT Static Route Add Command          "./DocScriptQ35/DHCP-SERVER/ip-dut-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
IP DUT Static Route Delete Command       "./DocScriptQ35/DHCP-SERVER/ip-dut-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
Pre Test Command                         ""
Post Test Command                        ""
Are You There Command                    ""
Are You There Tolerance Time             1                   # (0x00000001)
DHCP Server Suite Setup Command          "./DocScriptQ35/DHCP-SERVER/dhcp-server-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Server Restart Command              "./DocScriptQ35/DHCP-SERVER/dhcp-server-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Server Start Command                "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Server Lease Time Command           "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Server Address Pool Command         "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Server Option Configure Command     "./DocScriptQ35/DHCP-SERVER/dhcp-server-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Server Reset Command                "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Server Ping Check Command           "./DocScriptQ35/DHCP-SERVER/dhcp-server-ping-check-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Server Allow This Client Command    "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DHCP Server Supports Infinite Lease      True
DHCP Server Supports Responding to Registered Clients Only True
DHCP Listen Time                         200                 # (0x000000C8)
DHCP Lease Time                          200                 # (0x000000C8)
DHCP Tolerance Time                      2                   # (0x00000002)
DHCP Tolerance Factor                    1                   # (0x00000001)
DHCP Process Time                        2                   # (0x00000002)
DHCP First Retransmission Interval       4                   # (0x00000004)

# Parameter File End.

Number of unused prefixes in config file is set to zero
Setting number of unused prefixes to default value 255

# Configuration File: /opt/Ixia/IxANVL880/ANVL-SRC/DocUserQ35/anvldhcpserver.cfg

License Server Location                  
DUT Hostname                             128.224.166.238
DUT Username                             
DUT Prompt                               ""
DUT Password Level0                      
DUT Password Level1                      
DUT Custom Entry1                        
DUT Custom Entry2                        
DUT Custom Entry3                        
IP First Unused Net                      50.0.0.0
IP Number Unused Nets                    100                 # (0x00000064)
IP Unused Net Mask                       255.0.0.0

Ethernet Interface                       eth3
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:28
  IP DUT Address                           30.1.1.5
  IP ANVL Address                          30.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Broadcast Address                     30.1.1.255
  IP First Unused Address                  30.1.1.160
  IP Number Unused Addresses               50                # (0x00000032)

Ethernet Interface                       eth4
  Interface Enabled                        True
  DUT Interface                            ""
  DUT MAC Address                          00:15:17:C8:90:29
  IP DUT Address                           40.1.1.5
  IP ANVL Address                          40.1.1.150
  IP Subnet Mask                           255.255.255.0
  IP Broadcast Address                     40.1.1.255
  IP First Unused Address                  40.1.1.160
  IP Number Unused Addresses               50                # (0x00000032)

# Configuration File End.

WARNING: It is recommended that the value of lease time should
WARNING: kept higher than 5 seconds since in various cases,
WARNING: verification of T1 and T2 (Ref: rfc2131) is done which
WARNING: are fractions of 'DHCP Lease Time'. Keeping it too low
WARNING: may cause the T1 and T2 to become too low for proper
WARNING: verifications.
WARNING: Too high values are also deprreciated since it will
WARNING: lead to unnecessary long running of tests which
WARNING: may not add any value to the test results.
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
30.1.1.5 255.255.255.0 30.1.1.0 30.1.1.255 40.1.1.5 255.255.255.0 40.1.1.0 40.1.1.255

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-suite-setup-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> ipAttach 0,"gei"
value = 0 = 0x0
-> cmd ifconfig gei0 inet add 30.1.1.5 netmask 255.255.255.0 up
-> ipAttach 1,"gei"
value = 0 = 0x0
-> cmd ifconfig gei1 inet add 40.1.1.5 netmask 255.255.255.0 up
-> cmd ipd kill ipdhcps
ipd: kill ipdhcps ok
-> cmd ipd start ipdhcps
ipd: start ipdhcps ok
-> exit
Au revoir!
Connection closed by foreign host.

Starting Active Validation for DHCP Server for
all 2 DUT interface(s)

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:02 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:02 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:03 for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 02:02:00:00:00:03 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 2
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <CLIENT-1>     |            |
  +----------------+            |
                                |            +----------------+
                                |          N0|                |
                                +------------+<DIface-0>      |
                                             |                |
                                +------------+<DIface-1>      |
                                |          N1|           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N1          |
  |                +------------+
  |                |<AIface-1>
  | <CLIENT-2>     |
  +----------------+


Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 40.1.1.160
End IP Address   : 40.1.1.210
Subnet           : 40.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 40.1.1.0 255.255.255.0 40.1.1.160 40.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:40.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:40.1.1.160
POOL_RANGE_END:40.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 40.1.1.0 255.255.255.0

-> cmd dhcps pool add 40.1.1.0 40.1.1.160 40.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 2
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 40.1.1.0        netmask: 255.255.255.0  
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Transiting local client state from INIT to selecting
through <DIface-0>

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT
FF:FF:FF:FF:FF:FF < 02:02:00:00:00:02 IP 255.255.255.255 < 0.0.0.0 UDP dhcp server<-dhcp client DHCP DHCPDISCOVER Message


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>
02:02:00:00:00:02 < 00:15:17:C8:90:28 IP 30.1.1.160 < 30.1.1.5 UDP dhcp client<-dhcp server DHCP DHCPOFFER Message


Received DHCPOFFER Message from DUT

Transiting local client state from INIT to selecting
through <DIface-1>

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT
FF:FF:FF:FF:FF:FF < 02:02:00:00:00:03 IP 255.255.255.255 < 0.0.0.0 UDP dhcp server<-dhcp client DHCP DHCPDISCOVER Message


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-1>
02:02:00:00:00:03 < 00:15:17:C8:90:29 IP 40.1.1.160 < 40.1.1.5 UDP dhcp client<-dhcp server DHCP DHCPOFFER Message


Received DHCPOFFER Message from DUT

Active validation of DHCP Server was completed successfully
for all the interfaces provided in the configuration file
Continuing with tests .....

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:02
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:14:56 

IP Address   : 40.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:03
Lease time   : 864000 seconds
Expires at   : 1970/01/01 05:14:56 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:02
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:14:56 

IP Address   : 40.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:03
Lease time   : 864000 seconds
Expires at   : 1970/01/01 05:14:56 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

IP Address   : 40.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:03
Lease time   : 864000 seconds
Expires at   : 1970/01/01 05:14:56 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

-> cmd dhcps lease list 

IP Address   : 40.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:03
Lease time   : 864000 seconds
Expires at   : 1970/01/01 05:14:56 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 40.1.1.160
End IP Address   : 40.1.1.210
Subnet           : 40.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 40.1.1.0 255.255.255.0 40.1.1.160 40.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:40.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:40.1.1.160
POOL_RANGE_END:40.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 40.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:03
Lease time   : 864000 seconds
Expires at   : 1970/01/01 05:14:56 

-> cmd dhcps pool delete 40.1.1.0 40.1.1.160 40.1.1.210

-> cmd dhcps subnet delete 40.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:02 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:02 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:03 for <DIface-1>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1 02:02:00:00:00:03 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BA ARP Req 30.1.1.5

00:1B:21:7D:57:BA < 00:15:17:C8:90:28 ARP Rsp 30.1.1.150

Device Under Test found at 30.1.1.5 as 00:15:17:C8:90:28
FF:FF:FF:FF:FF:FF < 00:1B:21:7D:57:BB ARP Req 40.1.1.5

00:1B:21:7D:57:BB < 00:15:17:C8:90:29 ARP Rsp 40.1.1.150

Device Under Test found at 40.1.1.5 as 00:15:17:C8:90:29

This test suite tests statements from:
ANVL Test Suite DHCP Server
RFC 2131:  'Dynamic Host Configuration Protocol'
R. Droms, Bucknell University, March 1997

ANVL Test Suite Required Setup:
This suite expects to be running against a DHCP Server which can be
any hardware that has a DHCP Server implementation installed on it
The DHCP Server is expected to be configurable with pool(s) of IP
addresses depending on test requirements.
At least one of its interfaces needs to be configured statically with
IP address to act as DHCP Server Address

This suite should be run on an isolated test net which contains
only the Device Under Test (DUT).
Some tests may flood the network, some may erroneously fail if other
devices are on the network, and some may send packets which can
crash other devices on the network.

>> DHCP-SERVER-1.1
TEST_DESCRIPTION
DHCP Server Listens on UDP Port 67
TEST_REFERENCE
Setup Verification
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:06 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:06 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:06
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0003 (3)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79DB (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xF0BB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 435354578 (0x19F2FBD2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:06
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:06
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xB47A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 435354578 (0x19F2FBD2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:06
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:06
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:15:09 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:06
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:15:09 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:06 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:06 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-1.1: Passed

>> DHCP-SERVER-1.2
TEST_DESCRIPTION
DHCP Server Furnishes an IP address to the client when requested
TEST_REFERENCE
Setup Verification
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Verify that received DHCPOFFER Message contains all of the
        following:
        - 'yiaddr' field is greater than or equal to
           <DUT-SERVER-0-IP-POOL-START>
        - 'yiaddr' field is less than or equal to
           <DUT-SERVER-0-IP-POOL-END>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:07 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:07 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:07
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0004 (4)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79DA (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x5AD8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1538019323 (0x5BAC4FFB)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:07
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:07
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x1E97 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1538019323 (0x5BAC4FFB)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:07
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

'yiaddr' field in received DHCPOFFER Message is correctly set to 30.1.1.160 (greater than or equal to 30.1.1.160)

'yiaddr' field in received DHCPOFFER Message is correctly set to 30.1.1.160 (less than or equal 30.1.1.210)

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:07
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:15:28 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:07
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:15:28 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:07 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:07 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-1.2: Passed

>> DHCP-SERVER-2.1
TEST_DESCRIPTION
A host should not act as a DHCP server unless explicitly configured
to do so by a system administrator
TEST_REFERENCE
RFC 2131 Section 1 Page 2 'Introduction'
TEST_METHOD
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send DHCPOFFER Message
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:08 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:08 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:08
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0005 (5)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79D9 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x06ED (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1415097145 (0x5458AB39)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:08
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for no DHCPOFFER Message on <DIface-0>

DHCP Client <CLIENT-1> correctly did not receive DHCPOFFER Message from <DIface-0>

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:08 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:08 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-2.1: Passed

>> DHCP-SERVER-2.2
TEST_DESCRIPTION
The following list gives design goals specific to the transmission of
the network layer parameters.  DHCP must:
- Retain DHCP client configuration across DHCP client reboot
TEST_REFERENCE
RFC 2131 Section 1.6 Page 7 'Design Goals'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: Extracts the content of 'yiaddr' field to <extractedYiaddr>
- ANVL: DHCP Client <CLIENT-1> transit state machine to SELECTING
        state
- ANVL: Verify that received DHCPOFFER Message contains:
        - 'yiaddr' field is less than or equal to extractedYiaddr
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:09 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:09 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:09
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0006 (6)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79D8 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x6566 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 191534509 (0x0B6A95AD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:09
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:09
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x2925 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 191534509 (0x0B6A95AD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:09
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:09
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0007 (7)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79CB (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0xB3A7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 191534509 (0x0B6A95AD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:09
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:09
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x2625 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 191534509 (0x0B6A95AD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:09
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

Extracted the content of 'yiaddr' field (30.1.1.160) to <extractedYiaddr>

DHCP Client <CLIENT-1> sending DHCPRELEASE Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 02:02:00:00:00:09
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x0008 (8)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B29 (Correct)
IP: Source Address         = 30.1.1.160
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 258 
UDP: Checksum         = 0xF6BC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 191534509 (0x0B6A95AD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.160
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:09
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 7 (DHCPRELEASE)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:09
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0009 (9)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79D5 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x6566 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 191534509 (0x0B6A95AD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:09
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:09
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x2925 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 191534509 (0x0B6A95AD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:09
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> successfully transited to SELECTING state

'yiaddr' field in received DHCPOFFER Message is correctly set to 30.1.1.160 (less than or equal 30.1.1.160)

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:09
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:19:23 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:09
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:19:23 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:09 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:09 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-2.2: Passed

>> DHCP-SERVER-2.3
TEST_DESCRIPTION
The following list gives design goals specific to the transmission of
the network layer parameters.  DHCP must:
- Retain DHCP client configuration across server reboots
TEST_REFERENCE
RFC 2131 Section 1.6 Page 7 'Design Goals'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: Extracts the content of 'yiaddr' field to <extractedYiaddr>
 SETUP: Restart the DHCP Server running on DUT
        causing it to listen on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to SELECTING
        state
- ANVL: Verify that received DHCPOFFER Message contains:
        - 'yiaddr' field is set to extractedYiaddr
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:0A for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:0A 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:0A
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x000A (10)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79D4 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x1F80 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1030662542 (0x3D6EA98E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:0A
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:0A
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xE33E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1030662542 (0x3D6EA98E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:0A
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:0A
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x000B (11)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79C7 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x6DC1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1030662542 (0x3D6EA98E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:0A
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:0A
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xE03E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1030662542 (0x3D6EA98E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:0A
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

Extracted the content of 'yiaddr' field (30.1.1.160) to <extractedYiaddr>

Restarting DHCP server listening on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease flush -s expired

-> cmd dhcps lease flush -s offered

-> cmd dhcps lease list

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:0a
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:22:52 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPRELEASE Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 02:02:00:00:00:0A
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x000C (12)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3B25 (Correct)
IP: Source Address         = 30.1.1.160
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 258 
UDP: Checksum         = 0xB0D6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1030662542 (0x3D6EA98E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.160
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:0A
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 7 (DHCPRELEASE)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:0A
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x000D (13)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79D1 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x1F80 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1030662542 (0x3D6EA98E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:0A
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:0A
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xE33E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1030662542 (0x3D6EA98E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:0A
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> successfully transited to SELECTING state

'yiaddr' field in received DHCPOFFER Message is correctly set to 30.1.1.160

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:0a
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:19:43 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:0a
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:19:43 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:0A for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:0A 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-2.3: Passed

>> DHCP-SERVER-2.4
TEST_DESCRIPTION
A DHCP server always returns its own address in the 'server
identifier' option
TEST_REFERENCE
RFC 2131 Section 2 Page 10 'Protocol Summary'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to SELECTING
        state
- ANVL: Extracts the content of Source IP Address field to
        <extractedSrcIP>
- ANVL: Verify that received DHCPOFFER Message contains:
        - Message Option containing:
          - Type field set to 54 (Server Identifier Option)
          - Length field set to 4
          - Value set to extractedSrcIP
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:0B for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:0B 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:0B
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x000E (14)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79D0 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x22ED (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1677688719 (0x63FF7F8F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:0B
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:0B
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xE6AB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1677688719 (0x63FF7F8F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:0B
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> successfully transited to SELECTING state

Extracted the content of Source IP Address field (30.1.1.5) to <extractedSrcIP>

Message Option in received DHCPOFFER Message correctly contains Option Server Identifier (54) Length : 4 Value : 30.1.1.5 

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:0b
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:20:03 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:0b
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:20:03 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:0B for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:0B 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
exit
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-2.4: Passed

>> DHCP-SERVER-2.5
TEST_DESCRIPTION
The remaining bits of the flags field are reserved for future use.
They MUST be set to zero by clients and ignored by servers and relay
 agents
TEST_REFERENCE
RFC 2131 Section 2 Page 11 'Protocol Summary'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to SELECTING
        state
- ANVL: Verify that received DHCPOFFER Message contains:
        - Bits 2 to 16 of 'flags' field  is set to  0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:0C for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:0C 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:0C
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x000F (15)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79CF (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x31C3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 96784115 (0x05C4CEF3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:0C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:0C
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xF581 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 96784115 (0x05C4CEF3)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:0C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> successfully transited to SELECTING state

Received DHCPOFFER Message correctly contains:
- Bits 2 to 16 of 'flags' field correctly set to 000000000000000

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:0c
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:20:22 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:0c
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:20:22 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:0C for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:0C 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-2.5: Passed

>> DHCP-SERVER-2.6
TEST_DESCRIPTION
The remaining bits of the flags field are reserved for future use.
They MUST be set to zero by clients and ignored by servers and relay
 agents
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 2 Page 11 'Protocol Summary'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0> containing :
        - 'flags' field set to 0x7FFF(*INVALID*)
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:0D for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:0D 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0> containing :
  - 'flags' field set to 0x7FFF(*INVALID*) (01111111 11111111) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:0D
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0010 (16)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79CE (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x2DA6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1575942885 (0x5DEEFAE5)
DHCP: secs                      = 0
DHCP: flags                     = 0x7FFF (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:0D
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:0D
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xF164 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1575942885 (0x5DEEFAE5)
DHCP: secs                      = 0
DHCP: flags                     = 0x7FFF (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:0D
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:0d
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:20:41 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:0d
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:20:41 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:0D for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:0D 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-2.6: Passed

>> DHCP-SERVER-4.1
TEST_DESCRIPTION
The first four octets of the 'options' field of the DHCP message
contain the (decimal) values 99, 130, 83 and 99, respectively (this
is the same magic cookie as is defined in RFC 1497)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Verify that received DHCPOFFER Message contains:
        - First four octets of DHCP Options is set to
           <DHCP-MAGIC-COOKIE>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:0E for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:0E 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:0E
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0011 (17)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79CD (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xB7D8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1972951303 (0x7598D907)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:0E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:0E
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x7B97 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1972951303 (0x7598D907)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:0E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

First four octets of DHCP Options in received DHCPOFFER Message is correctly set to 99 130 83 99

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:0e
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:21:01 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:0e
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:21:01 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:0E for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:0E 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-4.1: Passed

>> DHCP-SERVER-4.2
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the option for DHCPOFFER Message)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to SELECTING
        state
- ANVL: Verify that received DHCPOFFER Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:0F for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:0F 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:0F
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0012 (18)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79CC (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xDCA8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1197007478 (0x4758E276)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:0F
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:0F
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xA067 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1197007478 (0x4758E276)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:0F
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> successfully transited to SELECTING state

Message Option in received DHCPOFFER Message correctly contains Option Message Type (53) 

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:0f
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:21:10 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:0f
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:21:10 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:0F for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:0F 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-4.2: Passed

>> DHCP-SERVER-4.3
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the option for DHCPACK Message)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: Verify that received DHCPACK Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:10 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:10 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:10
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0013 (19)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79CB (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x280E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1046781956 (0x3E64A004)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:10
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:10
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xEBCC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1046781956 (0x3E64A004)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:10
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:10
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0014 (20)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79BE (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x764F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1046781956 (0x3E64A004)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:10
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:10
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xE8CC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1046781956 (0x3E64A004)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:10
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

Message Option in received DHCPACK Message correctly contains Option Message Type (53) 

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:10
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:24:29 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:10
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:24:29 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:10 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:10 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-4.3: Passed

>> DHCP-SERVER-4.4
TEST_DESCRIPTION
One particular option - the "DHCP message type" option - must be
 included
in every DHCP message
(Note: This test verifies the option for DHCPNACK Message)
TEST_REFERENCE
RFC 2131 Section 3 Page 13 'The Client-Server Protocol'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: DHCP Client <CLIENT-2> transit state machine to SELECTING
        state
- ANVL:DHCP Client <CLIENT-2> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Value set to <CLIENT1-IP-ADDRESS>
- ANVL:DHCP Client <CLIENT-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPNAK Message
- ANVL: Verify that received DHCPNAK Message contains:
        - Message Option containing:
          - Type field set to 53 (Message Type Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:11 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:11 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:13 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:13 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <CLIENT-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <CLIENT-2>     |
  +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:11
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0015 (21)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79C9 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xAA41 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1987896759 (0x767CE5B7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:11
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:11
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x6E00 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1987896759 (0x767CE5B7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:11
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:11
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0016 (22)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79BC (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0xF882 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1987896759 (0x767CE5B7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:11
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:11
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x6B00 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1987896759 (0x767CE5B7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:11
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:13
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0017 (23)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79C7 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xB055 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1102910561 (0x41BD1461)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:13
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:13
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x7412 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1102910561 (0x41BD1461)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:13
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> successfully transited to SELECTING state

DHCP Client <CLIENT-2> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_REQUESTED_IP_ADDRESS_OPTION     (Requested IP Address) 
  - Value set to <CLIENT1-IP-ADDRESS> (30.1.1.160) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:13
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0018 (24)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79BA (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x5243 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1102910561 (0x41BD1461)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:13
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPNAK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5AA0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xCC23 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1102910561 (0x41BD1461)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:13
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 56 (Message) ---
DHCP: Length                   = 16
DHCP: Value                    = Invalid address
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-2> received expected DHCPNAK Message from <DIface-0>

Message Option in received DHCPNAK Message correctly contains Option Message Type (53) 

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:13
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:21:30 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:11
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:24:40 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:13
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:21:30 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:11
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:24:40 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:11 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:11 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:13 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:13 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-4.4: Passed

>> DHCP-SERVER-5.1
TEST_DESCRIPTION
Servers SHOULD be implemented so that network administrators MAY choose
to disable probes of newly allocated addresses
TEST_REFERENCE
RFC 2131 Section 3.1 Page 13
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure Client Ping Checking for DHCP Server
        running on DUT to FALSE
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL:DHCP Client <CLIENT-2> Sends DHCPDISCOVER Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Message
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-3


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:14 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:14 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:16 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:16 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <CLIENT-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <CLIENT-2>     |
  +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on the DUT to disable checking of
offered IP Address using ICMP Echo Request Message
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ping-check-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcps.do_icmp_address_check "true"
sysvar: ipdhcps.do_icmp_address_check=true ok
-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:14
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0019 (25)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79C5 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xD6CD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1412225912 (0x542CDB78)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:14
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:14
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x9A8C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1412225912 (0x542CDB78)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:14
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:14
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x001A (26)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79B8 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x250F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1412225912 (0x542CDB78)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:14
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:14
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x978C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1412225912 (0x542CDB78)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:14
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:16
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x001B (27)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79C3 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x788D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 519859943 (0x1EFC6EE7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:16
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> correctly did not receive ICMP Echo Message from <DIface-0>

Configuring DHCP Server on the DUT to enable checking of
offered IP Address using ICMP Echo Request Message
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ping-check-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd sysvar set -c -o ipdhcps.do_icmp_address_check "true"
sysvar: ipdhcps.do_icmp_address_check=true ok
-> exit
Au revoir!
Connection closed by foreign host.

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:14
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:24:53 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:14
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:24:53 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:14 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:14 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:16 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:16 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-5.1: Passed

>> DHCP-SERVER-5.2
TEST_DESCRIPTION
The server selected in the DHCPREQUEST message commits the
binding for the client to persistent storage and responds with a
DHCPACK message
TEST_REFERENCE
RFC 2131 Section 3.1 Page 16
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL:DHCP Client <CLIENT-1> Sends DHCPREQUEST Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPACK Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:17 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:17 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:17
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x001C (28)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79C2 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x4054 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 103858155 (0x0630BFEB)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:17
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:17
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x0413 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 103858155 (0x0630BFEB)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:17
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:17
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x001D (29)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79B5 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x8E95 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 103858155 (0x0630BFEB)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:17
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:17
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x0113 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 103858155 (0x0630BFEB)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:17
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPACK Message from <DIface-0>

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:17
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:28:36 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:17
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:28:36 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:17 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:17 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-5.2: Passed

>> DHCP-SERVER-5.3
TEST_DESCRIPTION
Any configuration parameters in the DHCPACK message SHOULD NOT
conflict with those in the earlier DHCPOFFER message to which the
client is responding
TEST_REFERENCE
RFC 2131 Section 3.1 Page 16
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Extracts the content of All the DHCP Message options to
        <extractedOptions>
- ANVL:DHCP Client <CLIENT-1> Sends DHCPREQUEST Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPACK Message
- ANVL: Verify that received DHCPACK Message contains:
        - Message Option containing extractedOptions
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:18 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:18 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:18
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x001E (30)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79C0 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x135A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1186901078 (0x46BEAC56)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:18
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:18
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xD718 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1186901078 (0x46BEAC56)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:18
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

Extracted the content of All the DHCP Message options (
IP Address Lease Time (51) Length : 4 Value : 200 seconds (3 minutes 20 seconds)
Server Identifier (54) Length : 4 Value : 30.1.1.5
Subnet Mask (1) Length : 4 Value : 255.255.255.0
End Option (255)) to <extractedOptions>

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:18
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x001F (31)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79B3 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x619B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1186901078 (0x46BEAC56)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:18
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:18
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xD418 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1186901078 (0x46BEAC56)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:18
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPACK Message from <DIface-0>

Message Option in received DHCPACK Message correctly contains Option IP Address Lease Time (51) Length : 4 Value : 200 seconds (3 minutes 20 seconds) 
Server Identifier (54) Length : 4 Value : 30.1.1.5 
Subnet Mask (1) Length : 4 Value : 255.255.255.0 
End Option (255) 

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:18
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:28:45 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:18
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:28:45 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:18 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:18 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-5.3: Passed

>> DHCP-SERVER-5.4
TEST_DESCRIPTION
If the selected server is unable to satisfy the DHCPREQUEST message
(e.g., the requested network address has been allocated), the
server SHOULD respond with a DHCPNAK message
TEST_REFERENCE
RFC 2131 Section 3.1 Page 16
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: DHCP Client <CLIENT-2> transit state machine to SELECTING
        state
- ANVL:DHCP Client <CLIENT-2> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Value set to <CLIENT1-IP-ADDRESS>
- ANVL:DHCP Client <CLIENT-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPNAK Message
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-3


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:19 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:19 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:1B for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:1B 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <CLIENT-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <CLIENT-2>     |
  +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:19
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0020 (32)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79BE (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x584D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 608864726 (0x244A89D6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:19
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:19
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x1C0C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 608864726 (0x244A89D6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:19
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:19
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0021 (33)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79B1 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0xA68E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 608864726 (0x244A89D6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:19
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:19
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x190C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 608864726 (0x244A89D6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:19
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:1B
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0022 (34)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79BC (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x5724 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1862942781 (0x6F0A403D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:1B
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:1B
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x1AE1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1862942781 (0x6F0A403D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:1B
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> successfully transited to SELECTING state

DHCP Client <CLIENT-2> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_REQUESTED_IP_ADDRESS_OPTION     (Requested IP Address) 
  - Value set to <CLIENT1-IP-ADDRESS> (30.1.1.160) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:1B
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0023 (35)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79AF (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0xF911 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1862942781 (0x6F0A403D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:1B
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPNAK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5AA0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x72F2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1862942781 (0x6F0A403D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:1B
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 56 (Message) ---
DHCP: Length                   = 16
DHCP: Value                    = Invalid address
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-2> received expected DHCPNAK Message from <DIface-0>

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:19
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:29:06 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:1b
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:25:56 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:19
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:29:06 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:1b
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:25:56 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:19 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:19 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:1B for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:1B 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-5.4: Passed

>> DHCP-SERVER-5.5
TEST_DESCRIPTION
The server selected in the DHCPREQUEST message commits the
binding for the client to persistent storage and responds with a
DHCPACK message containing the configuration parameters for the
requesting client...
The server SHOULD mark an address offered to a client in a DHCPOFFER
message as available if the server receives no DHCPREQUEST message from
that client
(Note: In this test the two emulated clients are to be provided the
       only IP address configured in the DUT IP Pool after
       the Server Reboot causes all non persistent information about
       the client from which the server did not receicve DHCPREQUEST
 Message
       to get flushed)
TEST_REFERENCE
RFC 2131 Section 3.1 Page 16
'Client-server interaction - allocating a network address'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-START>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to SELECTING
        state
- ANVL: Extracts the content of 'yiaddr' field to <extractedYiaddr>
 SETUP: Restart the DHCP Server running on DUT
        causing it to listen on 1 interface(s)
- ANVL: DHCP Client <CLIENT-2> transit state machine to SELECTING
        state
- ANVL: Verify that received DHCPOFFER Message contains:
        - 'yiaddr' field is set to extractedYiaddr
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-3


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:1C for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:1C 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:1E for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:1E 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <CLIENT-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <CLIENT-2>     |
  +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.160
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.160 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.160
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.160

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.160     (1 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:1C
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0024 (36)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79BA (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xC192 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1217920064 (0x4897FC40)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:1C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:1C
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x8551 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1217920064 (0x4897FC40)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:1C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> successfully transited to SELECTING state

Extracted the content of 'yiaddr' field (30.1.1.160) to <extractedYiaddr>

Restarting DHCP server listening on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-restart-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease flush -s expired

-> cmd dhcps lease flush -s offered

-> cmd dhcps lease list

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:1E
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0025 (37)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79B9 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xB36F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 628632961 (0x25782D81)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:1E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:1E
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x772E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 628632961 (0x25782D81)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:1E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> successfully transited to SELECTING state

'yiaddr' field in received DHCPOFFER Message is correctly set to 30.1.1.160

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:1e
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:26:18 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.160
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.160 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.160
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:1e
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:26:18 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.160

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:1C for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:1C 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:1E for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:1E 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-5.5: Passed

>> DHCP-SERVER-6.1
TEST_DESCRIPTION
Servers SHOULD NOT check that the client's network address is already
 in use
TEST_REFERENCE
RFC 2131 Section 3.2 Page 18
'Client-server interaction - reusing a previously allocated network
 address'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: Extracts the content of 'yiaddr' field to <extractedYiaddr>
- ANVL: Wait till (<CLIENT1-RENEWAL-TIME>/2) so that any client
        verification ICMP requests from server get flushed
- ANVL: DHCP Client <CLIENT-1> transit state machine to INIT-REBOOT
        state
- ANVL:DHCP Client <CLIENT-1> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Length field set to 4
          - Value set to extractedYiaddr
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send ICMP Echo Message
(Note: Server will not send ICMP Echo Message because
        DUT has prior knowledge of the client's configuration)
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:1F for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:1F 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:1F
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0026 (38)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79B8 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x6C90 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1789800233 (0x6AAE2F29)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:1F
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:1F
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x304F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1789800233 (0x6AAE2F29)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:1F
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:1F
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0027 (39)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79AB (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0xBAD1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1789800233 (0x6AAE2F29)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:1F
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:1F
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x2D4F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1789800233 (0x6AAE2F29)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:1F
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

Extracted the content of 'yiaddr' field (30.1.1.160) to <extractedYiaddr>

Waiting (up to 50.000 seconds) so that any client verification ICMP requests from server get flushed

DHCP Client <CLIENT-1> successfully transited to INIT-REBOOT state

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_REQUESTED_IP_ADDRESS_OPTION     (Requested IP Address) 
  - Length field set to 4 (4) 
  - Value set to extractedYiaddr (30.1.1.160) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:1F
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x0028 (40)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79B0 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 258 
UDP: Checksum         = 0x5A5D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 798238917 (0x2F9428C5)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:1F
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for no ICMP Echo Request Message on <DIface-0>

DHCP Client <CLIENT-1> correctly did not receive ICMP Echo Message from <DIface-0>

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:1f
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:30:29 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:1f
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:30:29 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:1F for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:1F 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-6.1: Passed

>> DHCP-SERVER-6.3
TEST_DESCRIPTION
The server MUST broadcast the DHCPNAK message to the 0xffffffff
broadcast address because the client may not have a correct network
address or subnet mask, and the client may not be answering ARP requests
TEST_REFERENCE
RFC 2131 Section 3.2 Page 19
'Client-server interaction - reusing a previously allocated network
 address'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: DHCP Client <CLIENT-2> transit state machine to SELECTING
        state
- ANVL:DHCP Client <CLIENT-2> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Value set to <CLIENT1-IP-ADDRESS>
- ANVL:DHCP Client <CLIENT-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPNAK Message
- ANVL: Verify that received DHCPNAK Message contains:
        - Destination IP Address field is set to 0xffffffff
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:20 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:20 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:22 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:22 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <CLIENT-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <CLIENT-2>     |
  +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:20
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0029 (41)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79B5 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x8740 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 893864415 (0x354749DF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:20
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:20
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x4AFF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 893864415 (0x354749DF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:20
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:20
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x002A (42)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79A8 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0xD581 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 893864415 (0x354749DF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:20
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:20
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x47FF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 893864415 (0x354749DF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:20
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:22
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x002B (43)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79B3 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x058E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 313060910 (0x12A8EE2E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:22
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:22
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xC94A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 313060910 (0x12A8EE2E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:22
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> successfully transited to SELECTING state

DHCP Client <CLIENT-2> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_REQUESTED_IP_ADDRESS_OPTION     (Requested IP Address) 
  - Value set to <CLIENT1-IP-ADDRESS> (30.1.1.160) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:22
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x002C (44)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79A6 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0xA77B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 313060910 (0x12A8EE2E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:22
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPNAK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5AA0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x215C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 313060910 (0x12A8EE2E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:22
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 56 (Message) ---
DHCP: Length                   = 16
DHCP: Value                    = Invalid address
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-2> received expected DHCPNAK Message from <DIface-0>

Destination IP Address field in received DHCPNAK Message is correctly set to 255.255.255.255

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:20
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:34:01 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:22
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:30:51 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:20
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:34:01 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:22
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:30:51 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:20 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:20 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:22 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:22 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-6.3: Passed

>> DHCP-SERVER-6.4
TEST_DESCRIPTION
Otherwise, the server MUST send the DHCPNAK message to the IP
address of the BOOTP relay agent, as recorded in 'giaddr'
TEST_REFERENCE
RFC 2131 Section 3.2 Page 19
'Client-server interaction - reusing a previously allocated network
 address'
TEST_METHOD
 SETUP: Configure DUT to add static route for network
        <RELAY-AGENT1-IP-POOL-SUBNET>
        (mask <RELAY-AGENT1-IP-POOL-SUBNETMASK>) using gateway
         <AIface-0-IP-ADDRESS> through <DIface-0>
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <RELAY-AGENT1-IP-POOL-START>
       - End of pool as <RELAY-AGENT1-IP-POOL-END>
       - Subnet as <RELAY-AGENT1-IP-POOL-SUBNET>
       - Subnet Mask as <RELAY-AGENT1-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: Initialize a DHCP Relay Agent working between ANVL and DUT
        indicating client1 is in a different subnet than any of DUT
        interfaces, so all DHCP Messages sent by emulated client(s)
        will have non-zero 'giaddr' field value
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: Initialize a DHCP Relay Agent working between ANVL and DUT
        indicating client2 is in a different subnet than any of DUT
        interfaces, so all DHCP Messages sent by emulated client(s)
        will have non-zero 'giaddr' field value
- ANVL: DHCP Client <CLIENT-2> transit state machine to SELECTING
        state
- ANVL:DHCP Client <CLIENT-2> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Length field set to 4
          - Value set to <CLIENT1-IP-ADDRESS>
- ANVL:DHCP Client <CLIENT-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPNAK Message
- ANVL: Verify that received DHCPNAK Message contains:
        - Destination IP Address field is set to <RELAY-1-IP-ADDR>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-6


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:23 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:23 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:24 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:24 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

   +-------+--------+
   |                |
   |                |
   |                |
   |                |
   | <CLIENT-1>     |
   +-------+--------+
<AIface-0> |N1
           |
           |
           |
           |
           |
           |
           |             +----------------+            +----------------+
     +-----+----+        |                |            |                |
     |          |      N1|                |N0        N0|                |
     |   HUB    +........+................+............+<DIface-0>      |
     |          |        |                |<AIface-0>  |                |
     +-----+----+        |<RELAY-AGENT1>  |            |           DUT  |
           |             +-------+--------+            +----------------+
           |
           |
           |
           |
           |
           |
 <AIface-0>|N1
   +-------+--------+
   |                |
   |                |
   |                |
   |                |
   | <CLIENT-2>     |
   +----------------+


Causing DUT to add a static route on DUT for
Destination Address 57.0.0.0
Gateway Address 30.1.1.150
outgoing interface <DIface-0>
Netmask 255.255.255.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
57.0.0.0 30.1.1.150 0 255.255.255.0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/ip-dut-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -net -netmask 255.255.255.0 57.0.0.0 30.1.1.150
    add net 57.0.0.0: netmask 255.255.255.0: gateway 30.1.1.150
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
57.0.0.0/24                     30.1.1.150                    UGS      0     gei0   0    
localhost                       localhost                     UH       3112  lo0    0    
128.224.166.0/23                vxTarget                      UC       3780  gei2   0    
vxTarget                        vxTarget                      UH       17664 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       681630lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 57.0.0.11
End IP Address   : 57.0.0.21
Subnet           : 57.0.0.0
Subnet Mask      : 255.255.255.0
for <DIface-2>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2 57.0.0.0 255.255.255.0 57.0.0.11 57.0.0.21 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:57.0.0.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:57.0.0.11
POOL_RANGE_END:57.0.0.21
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 57.0.0.0 255.255.255.0

-> cmd dhcps pool add 57.0.0.0 57.0.0.11 57.0.0.21

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  
     Subnet: 57.0.0.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.
Initializing a DHCP Relay Agent working between ANVL and DUT
indicating client1 is in a different subnet than any of DUT
interfaces, so all DHCP Messages sent by emulated client(s)
will have non-zero 'giaddr' field value

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x002D (45)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79B1 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x6CBB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 1
DHCP: xid                       = 2117591663 (0x7E37E26F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 57.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:23
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xA5AD (42413)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7BF1 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 57.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB882 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2117591663 (0x7E37E26F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 57.0.0.11
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 57.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:23
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 864000 seconds (10 days )
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x002E (46)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79A4 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x50E3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 1
DHCP: xid                       = 2117591663 (0x7E37E26F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 57.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:23
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 57.0.0.11
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xA5AE (42414)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7BF0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 57.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB582 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2117591663 (0x7E37E26F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 57.0.0.11
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 57.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:23
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 864000 seconds (10 days )
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state
Initializing a DHCP Relay Agent working between ANVL and DUT
indicating client2 is in a different subnet than any of DUT
interfaces, so all DHCP Messages sent by emulated client(s)
will have non-zero 'giaddr' field value

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x002F (47)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79AF (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x7ADD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 1
DHCP: xid                       = 1224214924 (0x48F8098C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 57.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:24
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xA5AF (42415)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7BEF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 57.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xC6A3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1224214924 (0x48F8098C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 57.0.0.12
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 57.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:24
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 864000 seconds (10 days )
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> successfully transited to SELECTING state

DHCP Client <CLIENT-2> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_REQUESTED_IP_ADDRESS_OPTION     (Requested IP Address) 
  - Length field set to 4 (4) 
  - Value set to <CLIENT1-IP-ADDRESS> (57.0.0.11) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0030 (48)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79A2 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x0361 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 1
DHCP: xid                       = 1224214924 (0x48F8098C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 57.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:24
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 57.0.0.11
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPNAK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xA5B0 (42416)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7BEE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 57.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x5DAB (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1224214924 (0x48F8098C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 57.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:24
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 56 (Message) ---
DHCP: Length                   = 16
DHCP: Value                    = Invalid address
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-2> received expected DHCPNAK Message from <DIface-0>

Destination IP Address field in received DHCPNAK Message is correctly set to 57.0.0.1

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 57.0.0.11
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:23
Lease time   : 864000 seconds
Expires at   : 1970/01/11 05:31:05 

IP Address   : 57.0.0.12
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:24
Lease time   : 864000 seconds
Expires at   : 1970/01/01 05:31:15 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 57.0.0.11
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:23
Lease time   : 864000 seconds
Expires at   : 1970/01/11 05:31:05 

IP Address   : 57.0.0.12
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:24
Lease time   : 864000 seconds
Expires at   : 1970/01/01 05:31:15 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

IP Address   : 57.0.0.11
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:23
Lease time   : 864000 seconds
Expires at   : 1970/01/11 05:31:05 

IP Address   : 57.0.0.12
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:24
Lease time   : 864000 seconds
Expires at   : 1970/01/01 05:31:15 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 57.0.0.11
End IP Address   : 57.0.0.21
Subnet           : 57.0.0.0
Subnet Mask      : 255.255.255.0
for <DIface-2>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2 57.0.0.0 255.255.255.0 57.0.0.11 57.0.0.21 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:57.0.0.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:57.0.0.11
POOL_RANGE_END:57.0.0.21
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 57.0.0.11
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:23
Lease time   : 864000 seconds
Expires at   : 1970/01/11 05:31:05 

IP Address   : 57.0.0.12
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:24
Lease time   : 864000 seconds
Expires at   : 1970/01/01 05:31:15 

-> cmd dhcps pool delete 57.0.0.0 57.0.0.11 57.0.0.21

-> cmd dhcps subnet delete 57.0.0.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to delete static route on DUT for
Destination Address 57.0.0.0
Gateway Address 30.1.1.150
outgoing interface <DIface-0>
Netmask 255.255.255.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
57.0.0.0 30.1.1.150 0 255.255.255.0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/ip-dut-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -net 57.0.0.0
    delete net 57.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       1     gei0   0    
30.1.1.5                        30.1.1.5                      UH       2     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       3112  lo0    0    
128.224.166.0/23                vxTarget                      UC       3784  gei2   0    
vxTarget                        vxTarget                      UH       17832 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       687954lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:23 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:23 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:24 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:24 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-6.4: Passed

>> DHCP-SERVER-7.1
TEST_DESCRIPTION
A client acquires a lease for a network address for a fixed period of
time (which may be infinite).  Throughout the protocol, times are to
be represented in units of seconds.  The time value of 0xffffffff is
reserved to represent "infinity"
(Note: In this test we simply check the syntactic usage of lease time
       DHCP option value since actual verification of 'infinity' is
       beyond our scope)
TEST_REFERENCE
RFC 2131 Section 3.3 Page 20
'Interpretation and representation of time values'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of 0xffffffff on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0> containing :
        - Message Option containing:
          - Type field set to 51 (IP Address Lease Time Option)
          - Length field set to 4
          - Value set to 0xffffffff
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Verify that received DHCPOFFER Message contains:
        - Message Option containing:
          - Type field set to 51 (IP Address Lease Time Option)
          - Length field set to 4
          - Value set to 0xffffffff
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:25 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:25 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 4294967295 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 4294967295 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "-1"

-> cmd dhcps config set 40.1.1.0 default-lease-time "-1"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_IP_ADDRESS_LEASE_TIME (IP Address Lease Time) 
  - Length field set to 4 (4) 
  - Value set to 0xffffffff (4294967295 seconds (Infinite)) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:25
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x0031 (49)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79A7 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 258 
UDP: Checksum         = 0x9B22 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 128790658 (0x07AD3082)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:25
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 4294967295 seconds (Infinite)
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:25
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x59F2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 128790658 (0x07AD3082)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:25
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 4294967295 seconds (Infinite)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

Message Option in received DHCPOFFER Message correctly contains Option IP Address Lease Time (51) Length : 4 Value : 4294967295 seconds (Infinite) 

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 4294967295 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:25
Lease time   : -1 seconds
Expires at   : 1970/01/01 05:31:28 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:25
Lease time   : -1 seconds
Expires at   : 1970/01/01 05:31:28 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:25 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:25 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-7.1: Passed

>> DHCP-SERVER-8.1
TEST_DESCRIPTION
Servers receiving a DHCPINFORM message construct a DHCPACK message with
any local configuration parameters appropriate for the client
TEST_REFERENCE
RFC 2131 Section 3.4 Page 21
'Obtaining parameters with externally configured network address'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP 3 (Router Option) with value
        <DIface-0-IP-ADDRESS>
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPINFORM Message to DUT
       through <DIface-0> containing :
        - Source IP Address field set to <AIface-0-IP-ADDRESS>
        - 'ciaddr' field set to <AIface-0-IP-ADDRESS>
        - Message Option containing:
          - Type field set to 55 (Parameter Request List Option)
          - Length field set to 1
          - Value set to 3 (Router Option)
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPACK Message
- ANVL: Verify that received DHCPACK Message contains:
        - Message Option containing:
          - Type field set to 3 (Router Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:26 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:26 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server with option Router set to value
30.1.1.5 to server client(s) connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 3 30.1.1.5

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-option-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
DIFACE:0

DHCP_OPTION:3

VALUE:30.1.1.5

spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps option add 30.1.1.0 3  "30.1.1.5"

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPINFORM Message to DUT through <DIface-0> containing :
  - Source IP Address field set to <AIface-0-IP-ADDRESS>     (30.1.1.150) 
  - 'ciaddr' field set to <AIface-0-IP-ADDRESS> (30.1.1.150) 
- Message Option containing:
  - Type field set to DHCP_PARAM_REQ_LIST_OPTION (Parameter Request List) 
  - Length field set to 1 (1) 
  - Value set to DHCP_ROUTER_OPTION (
  3 = Router
) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:26
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 275 bytes
IP: Identification         = 0x0032 (50)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5A12 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 255 
UDP: Checksum         = 0xDAFA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1405457709 (0x53C5952D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.150
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:26
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 1
DHCP:   3 = Router
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xB476 (46198)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x8692 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xA552 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1405457709 (0x53C5952D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.150
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:26
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 3 (Router) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPACK Message from <DIface-0>

Message Option in received DHCPACK Message correctly contains Option Router (3) 

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:26 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:26 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-8.1: Passed

>> DHCP-SERVER-8.2
TEST_DESCRIPTION
Servers receiving a DHCPINFORM message construct a DHCPACK message
 without ...
filling in 'yiaddr' or including lease time parameters
(Note: This test verifies that 'yiaddr' is not filled in)
TEST_REFERENCE
RFC 2131 Section 3.4 Page 21
'Obtaining parameters with externally configured network address'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPINFORM Message to DUT
       through <DIface-0> containing :
        - Source IP Address field set to <AIface-0-IP-ADDRESS>
        - 'ciaddr' field set to <AIface-0-IP-ADDRESS>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPACK Message
- ANVL: Verify that received DHCPACK Message contains:
        - 'yiaddr' field is set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:27 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:27 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPINFORM Message to DUT through <DIface-0> containing :
  - Source IP Address field set to <AIface-0-IP-ADDRESS>     (30.1.1.150) 
  - 'ciaddr' field set to <AIface-0-IP-ADDRESS> (30.1.1.150) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:27
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0033 (51)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5A14 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x6DC0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1810687620 (0x6BECE684)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.150
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:27
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xB477 (46199)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x8691 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x40F5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1810687620 (0x6BECE684)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.150
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:27
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPACK Message from <DIface-0>

'yiaddr' field in received DHCPACK Message is correctly set to 0.0.0.0

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:27 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:27 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-8.2: Passed

>> DHCP-SERVER-8.3
TEST_DESCRIPTION
Servers receiving a DHCPINFORM message construct a DHCPACK message
 without ...
filling in 'yiaddr' or including lease time parameters
(Note: This test verifies that no lease time parameteres are present)
TEST_REFERENCE
RFC 2131 Section 3.4 Page 21
'Obtaining parameters with externally configured network address'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPINFORM Message to DUT
       through <DIface-0> containing :
        - Source IP Address field set to <AIface-0-IP-ADDRESS>
        - 'ciaddr' field set to <AIface-0-IP-ADDRESS>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPACK Message
- ANVL: Verify that received DHCPACK Message contains:
        - Message Option containing:
          - Type field is not set to 51 (IP Address Lease Time Option)
        - Message Option containing:
          - Type field is not set to 58 (Renewal (T1) Time Value
             Option)
        - Message Option containing:
          - Type field is not set to 59 (Rebinding (T2) Time Value
             Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:28 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:28 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPINFORM Message to DUT through <DIface-0> containing :
  - Source IP Address field set to <AIface-0-IP-ADDRESS>     (30.1.1.150) 
  - 'ciaddr' field set to <AIface-0-IP-ADDRESS> (30.1.1.150) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0034 (52)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5A13 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x0B59 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 290366345 (0x114EA389)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.150
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xA6EF (42735)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x9419 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xDE8D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 290366345 (0x114EA389)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.150
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:28
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPACK Message from <DIface-0>

Message Option in received DHCPACK Message correctly does not contain Option IP Address Lease Time (51) 

Message Option in received DHCPACK Message correctly does not contain Option Renewal (T1) Time Value (58) 

Message Option in received DHCPACK Message correctly does not contain Option Rebinding (T2) Time Value (59) 

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:28 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:28 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-8.3: Passed

>> DHCP-SERVER-8.4
TEST_DESCRIPTION
The servers SHOULD unicast the DHCPACK reply to the address given in
the 'ciaddr' field of the DHCPINFORM message
TEST_REFERENCE
RFC 2131 Section 3.4 Page 21
'Obtaining parameters with externally configured network address'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPINFORM Message to DUT
       through <DIface-0> containing :
        - Source IP Address field set to <AIface-0-IP-ADDRESS>
        - 'ciaddr' field set to <AIface-0-IP-ADDRESS>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPACK Message
- ANVL: Verify that received DHCPACK Message contains:
        - Destination IP Address field is set to <AIface-0-IP-ADDRESS>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:29 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:29 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPINFORM Message to DUT through <DIface-0> containing :
  - Source IP Address field set to <AIface-0-IP-ADDRESS>     (30.1.1.150) 
  - 'ciaddr' field set to <AIface-0-IP-ADDRESS> (30.1.1.150) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:29
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0035 (53)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5A12 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x9471 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 478023488 (0x1C7E0F40)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.150
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:29
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xA6F0 (42736)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x9418 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x67A6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 478023488 (0x1C7E0F40)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.150
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:29
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPACK Message from <DIface-0>

Destination IP Address field in received DHCPACK Message is correctly set to 30.1.1.150

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:29 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:29 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
exit
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-8.4: Passed

>> DHCP-SERVER-8.5
TEST_DESCRIPTION
The server SHOULD check the network address in a DHCPINFORM message
for consistency, but MUST NOT check for an existing lease
(Note: This test verifies that the DUT checks that the source IP address
       of DHCPINFORM message is consistent)
TEST_REFERENCE
RFC 2131 Section 3.4 Page 21
NEGATIVE
'Obtaining parameters with externally configured network address'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPINFORM Message to DUT
       through <DIface-0> containing :
        - Source IP Address field set to
           <IP-UNUSED-ADDRESS>(*INVALID*)
        - 'ciaddr' field set to <DUT-SERVER-0-IP-POOL-START>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send DHCPACK Message
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:2A for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:2A 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPINFORM Message to DUT through <DIface-0> containing :
  - Source IP Address field set to     <IP-UNUSED-ADDRESS>(*INVALID*) (56.0.0.1) 
  - 'ciaddr' field set to <DUT-SERVER-0-IP-POOL-START> (30.1.1.160) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:2A
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0036 (54)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x41A7 (Correct)
IP: Source Address         = 56.0.0.1
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x023A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 171481928 (0x0A389B48)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.160
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:2A
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for no DHCPACK Message on <DIface-0>

DHCP Client <CLIENT-1> correctly did not receive DHCPACK Message from <DIface-0>

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:2A for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:2A 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-8.5: Passed

>> DHCP-SERVER-8.6
TEST_DESCRIPTION
The server SHOULD check the network address in a DHCPINFORM message
for consistency, but MUST NOT check for an existing lease
(Note: This test verifies that the DUT does not check if the source IP
 address
       of DHCPINFORM message is in existing lease database of the DUT)
TEST_REFERENCE
RFC 2131 Section 3.4 Page 21
'Obtaining parameters with externally configured network address'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-2> transit state machine to BOUND state
- ANVL: Extracts the content of 'yiaddr' field to <extractedYiaddr>
- ANVL:DHCP Client <CLIENT-1> Sends DHCPINFORM Message to DUT
       through <DIface-0> containing :
        - Source IP Address field set to extractedYiaddr
        - 'ciaddr' field set to extractedYiaddr
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPACK Message
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-3


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:2B for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:2B 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:2D for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:2D 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <CLIENT-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <CLIENT-2>     |
  +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:2D
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0037 (55)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79A7 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xD2DA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1322443948 (0x4ED2E4AC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:2D
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:2D
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x9699 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1322443948 (0x4ED2E4AC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:2D
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:2D
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0038 (56)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x799A (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x211C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1322443948 (0x4ED2E4AC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:2D
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:2D
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x9399 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1322443948 (0x4ED2E4AC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:2D
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-2> successfully transited to BOUND state

Extracted the content of 'yiaddr' field (30.1.1.160) to <extractedYiaddr>

DHCP Client <CLIENT-1> sending DHCPINFORM Message to DUT through <DIface-0> containing :
  - Source IP Address field set to extractedYiaddr (30.1.1.160) 
  - 'ciaddr' field set to extractedYiaddr (30.1.1.160) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:2B
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0039 (57)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5A04 (Correct)
IP: Source Address         = 30.1.1.160
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x7A0C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1907741783 (0x71B5D457)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.160
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:2B
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>
Received ARP Request for 30.1.1.160 from 30.1.1.5

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.160
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

Sending ARP Response for 30.1.1.160

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 02:02:00:00:00:2D
ARP: Source Protocol Address      = 30.1.1.160
ARP: Destination Hardware Address = 00:15:17:C8:90:28
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:2D
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x4E8A (20106)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xEC74 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x4D41 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1907741783 (0x71B5D457)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.160
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:2B
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPACK Message from <DIface-0>

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:2d
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:39:58 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:2d
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:39:58 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:2B for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:2B 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:2D for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:2D 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-8.6: Passed

>> DHCP-SERVER-9.1
TEST_DESCRIPTION
If a server receives a DHCPREQUEST message with an invalid 'requested
IP address', the server SHOULD respond to the client with a DHCPNAK
message
TEST_REFERENCE
RFC 2131 Section 3.5 Page 22 'Client parameters in DHCP'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: Extracts the content of 'yiaddr' field to <extractedYiaddr>
- ANVL: DHCP Client <CLIENT-2> transit state machine to SELECTING
        state
- ANVL:DHCP Client <CLIENT-2> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Value set to extractedYiaddr
- ANVL:DHCP Client <CLIENT-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPNAK Message
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-3


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:2E for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:2E 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:30 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:30 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <CLIENT-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <CLIENT-2>     |
  +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:2E
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x003A (58)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79A4 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xD0F2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 640814900 (0x26320F34)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:2E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:2E
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x94B1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 640814900 (0x26320F34)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:2E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:2E
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x003B (59)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7997 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x1F34 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 640814900 (0x26320F34)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:2E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:2E
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x91B1 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 640814900 (0x26320F34)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:2E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

Extracted the content of 'yiaddr' field (30.1.1.160) to <extractedYiaddr>

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:30
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x003C (60)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79A2 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x365A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 823500519 (0x31159EE7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:30
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:30
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xFA16 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 823500519 (0x31159EE7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:30
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> successfully transited to SELECTING state

DHCP Client <CLIENT-2> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_REQUESTED_IP_ADDRESS_OPTION     (Requested IP Address) 
  - Value set to extractedYiaddr (30.1.1.160) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:30
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x003D (61)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7995 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0xD847 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 823500519 (0x31159EE7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:30
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPNAK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5AA0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x5228 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 823500519 (0x31159EE7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:30
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 56 (Message) ---
DHCP: Length                   = 16
DHCP: Value                    = Invalid address
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-2> received expected DHCPNAK Message from <DIface-0>

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:30
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:37:09 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:2e
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:40:19 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:30
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:37:09 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:2e
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:40:19 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:2E for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:2E 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:30 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:30 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-9.1: Passed

>> DHCP-SERVER-9.2
TEST_DESCRIPTION
If a server receives a DHCPREQUEST message with an invalid 'requested
IP address', ... .The server may include an error message in the
'message' option
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 3.5 Page 22 'Client parameters in DHCP'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: Extracts the content of 'yiaddr' field to <extractedYiaddr>
- ANVL: DHCP Client <CLIENT-2> transit state machine to SELECTING
        state
- ANVL:DHCP Client <CLIENT-2> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Value set to extractedYiaddr(*INVALID*)
- ANVL:DHCP Client <CLIENT-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPNAK Message
- ANVL: Verify that received DHCPNAK Message contains:
        - Message Option containing:
          - Type field set to 56 (Message Option)
TEST_CLASSIFICATION
MAY
TEST_TOPOLOGY
TOPOLOGY-3


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:31 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:31 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:33 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:33 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <CLIENT-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <CLIENT-2>     |
  +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:31
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x003E (62)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x79A0 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xA904 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1550450919 (0x5C6A00E7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:31
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:31
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x6CC3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1550450919 (0x5C6A00E7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:31
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:31
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x003F (63)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7993 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0xF745 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1550450919 (0x5C6A00E7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:31
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:31
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x69C3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1550450919 (0x5C6A00E7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:31
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

Extracted the content of 'yiaddr' field (30.1.1.160) to <extractedYiaddr>

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:33
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0040 (64)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x799E (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x6D43 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2042634064 (0x79C01F50)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:33
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:33
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x3100 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2042634064 (0x79C01F50)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:33
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> successfully transited to SELECTING state

DHCP Client <CLIENT-2> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_REQUESTED_IP_ADDRESS_OPTION     (Requested IP Address) 
  - Value set to extractedYiaddr(*INVALID*) (30.1.1.160) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:33
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0041 (65)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7991 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x0F31 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2042634064 (0x79C01F50)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:33
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPNAK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5AA0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x8911 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2042634064 (0x79C01F50)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:33
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 56 (Message) ---
DHCP: Length                   = 16
DHCP: Value                    = Invalid address
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-2> received expected DHCPNAK Message from <DIface-0>

Message Option in received DHCPNAK Message correctly contains Option Message (56) 

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:31
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:40:31 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:33
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:37:21 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:31
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:40:31 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:33
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:37:21 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:31 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:31 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:33 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:33 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-9.2: Passed

>> DHCP-SERVER-10.1
TEST_DESCRIPTION
The last option must always be the 'end' option
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Verify that received DHCPOFFER Message contains:
        - Message Option containing:
          - 255 (End Option) at position Last
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:34 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:34 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:34
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0042 (66)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x799C (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x55B0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 976189043 (0x3A2F7673)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:34
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:34
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x196F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 976189043 (0x3A2F7673)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:34
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

Message Option in received DHCPOFFER Message is correctly set as  End Option (255) in position 4  

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:34
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:37:41 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:34
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:37:41 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:34 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:34 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-10.1: Passed

>> DHCP-SERVER-10.3
TEST_DESCRIPTION
To accommodate potentially incomplete network
connectivity, a server MUST choose an address as a 'server
identifier' that, to the best of the server's knowledge, is reachable
from the client
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: Extracts the content of Value field  of 54 (Server
        Identifier Option) to <serverId>
- ANVL: Extracts the content of Source Harware Address field to
        <serverHwAddr>
- ANVL:DHCP Client <CLIENT-1> Sends ARP Request Message to DUT
       through <DIface-0> containing :
        - ARP Target IP Address field set to serverId
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends ARP Response Message
- ANVL: Verify that received ARP Response Message contains:
        - ARP Sender MAC Address field is set to serverHwAddr
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:35 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:35 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:35
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0043 (67)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x799B (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xC773 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 205664924 (0x0C42329C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:35
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:35
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x8B32 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 205664924 (0x0C42329C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:35
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:35
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0044 (68)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x798E (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x15B5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 205664924 (0x0C42329C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:35
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:35
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x8832 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 205664924 (0x0C42329C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:35
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

Extracted the content of Value field  of 54 (Server Identifier Option) (30.1.1.5) to <serverId>

Extracted the content of Source Harware Address field (00:15:17:C8:90:28) to <serverHwAddr>

DHCP Client <CLIENT-1> sending ARP Request Message to DUT through <DIface-0> containing :
  - ARP Target IP Address field set to serverId (30.1.1.5) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:35
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 02:02:00:00:00:35
ARP: Source Protocol Address      = 30.1.1.160
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


Listening (up to 202.000 seconds) for ARP Response Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:35
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 02:02:00:00:00:35
ARP: Destination Protocol Address = 30.1.1.160
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


DHCP Client <CLIENT-1> received expected ARP Response Message from <DIface-0>

ARP Sender MAC Address field in received ARP Response is correctly set to 00:15:17:C8:90:28

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:35
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:41:00 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:35
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:41:00 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:35 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:35 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-10.3: Passed

>> DHCP-SERVER-10.4
TEST_DESCRIPTION
If the 'giaddr' field in a DHCP message from a client is non-zero,
the server sends any return messages to the 'DHCP server' port on the
BOOTP relay agent whose address appears in 'giaddr'
(Note: This test verifies the UDP destination port)
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Configure DUT to add static route for network
        <RELAY-AGENT1-IP-POOL-SUBNET>
        (mask <RELAY-AGENT1-IP-POOL-SUBNETMASK>) using gateway
         <AIface-0-IP-ADDRESS> through <DIface-0>
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <RELAY-AGENT1-IP-POOL-START>
       - End of pool as <RELAY-AGENT1-IP-POOL-END>
       - Subnet as <RELAY-AGENT1-IP-POOL-SUBNET>
       - Subnet Mask as <RELAY-AGENT1-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: Initialize a DHCP Relay Agent working between ANVL and DUT
        indicating client1 is in a different subnet than any of DUT
        interfaces, so all DHCP Messages sent by emulated client(s)
        will have non-zero 'giaddr' field value
- ANVL: DHCP Client <CLIENT-1> transit state machine to SELECTING
        state
- ANVL: Verify that received DHCPOFFER Message contains all of the
        following:
        - Source UDP Port field is set to 67
        - Destination UDP Port field is set to 67
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-5


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:36 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:36 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 5
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |       .........+..........................+                |
  |       .        |<AIface-0>      <DIface-0>|                |
  |<RELAY-AGENT1>  |                          |           DUT  |
  +-------+--------+                          +----------------+
          .N1
          .
<AIface-0>.N1
  +-------+--------+
  |                |
  |                |
  |                |
  |                |
  | <CLIENT-1>     |
  +----------------+


Causing DUT to add a static route on DUT for
Destination Address 58.0.0.0
Gateway Address 30.1.1.150
outgoing interface <DIface-0>
Netmask 255.255.255.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
58.0.0.0 30.1.1.150 0 255.255.255.0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/ip-dut-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -net -netmask 255.255.255.0 58.0.0.0 30.1.1.150
    add net 58.0.0.0: netmask 255.255.255.0: gateway 30.1.1.150
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       5     gei0   0    
30.1.1.5                        30.1.1.5                      UH       4     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
58.0.0.0/24                     30.1.1.150                    UGS      0     gei0   0    
localhost                       localhost                     UH       3112  lo0    0    
128.224.166.0/23                vxTarget                      UC       3842  gei2   0    
vxTarget                        vxTarget                      UH       19473 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       722412lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 58.0.0.11
End IP Address   : 58.0.0.21
Subnet           : 58.0.0.0
Subnet Mask      : 255.255.255.0
for <DIface-2>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2 58.0.0.0 255.255.255.0 58.0.0.11 58.0.0.21 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:58.0.0.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:58.0.0.11
POOL_RANGE_END:58.0.0.21
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 58.0.0.0 255.255.255.0

-> cmd dhcps pool add 58.0.0.0 58.0.0.11 58.0.0.21

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 58.0.0.0        netmask: 255.255.255.0  
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.
Initializing a DHCP Relay Agent working between ANVL and DUT
indicating client1 is in a different subnet than any of DUT
interfaces, so all DHCP Messages sent by emulated client(s)
will have non-zero 'giaddr' field value

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0045 (69)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7999 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x734C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 1
DHCP: xid                       = 2099502047 (0x7D23DBDF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 58.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:36
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x7360 (29536)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xAD3E (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 58.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xBD13 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2099502047 (0x7D23DBDF)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 58.0.0.11
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 58.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:36
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 864000 seconds (10 days )
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> successfully transited to SELECTING state

Source UDP Port field in received DHCPOFFER Message is correctly set to 67

Destination UDP Port field in received DHCPOFFER Message is correctly set to 67

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 58.0.0.11
End IP Address   : 58.0.0.21
Subnet           : 58.0.0.0
Subnet Mask      : 255.255.255.0
for <DIface-2>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2 58.0.0.0 255.255.255.0 58.0.0.11 58.0.0.21 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:58.0.0.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:58.0.0.11
POOL_RANGE_END:58.0.0.21
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 58.0.0.11
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:36
Lease time   : 864000 seconds
Expires at   : 1970/01/01 05:38:12 

-> cmd dhcps pool delete 58.0.0.0 58.0.0.11 58.0.0.21

-> cmd dhcps subnet delete 58.0.0.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to delete static route on DUT for
Destination Address 58.0.0.0
Gateway Address 30.1.1.150
outgoing interface <DIface-0>
Netmask 255.255.255.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
58.0.0.0 30.1.1.150 0 255.255.255.0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/ip-dut-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -net 58.0.0.0
    delete net 58.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       5     gei0   0    
30.1.1.5                        30.1.1.5                      UH       4     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       3112  lo0    0    
128.224.166.0/23                vxTarget                      UC       3845  gei2   0    
vxTarget                        vxTarget                      UH       19639 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       728072lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:36 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:36 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-10.4: Passed

>> DHCP-SERVER-10.5
TEST_DESCRIPTION
If the 'giaddr' field in a DHCP message from a client is non-zero,
the server sends any return messages to the 'DHCP server' port on the
BOOTP relay agent whose address appears in 'giaddr'
(Note: This test verifies the IP Destination address)
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Configure DUT to add static route for network
        <RELAY-AGENT1-IP-POOL-SUBNET>
        (mask <RELAY-AGENT1-IP-POOL-SUBNETMASK>) using gateway
         <AIface-0-IP-ADDRESS> through <DIface-0>
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <RELAY-AGENT1-IP-POOL-START>
       - End of pool as <RELAY-AGENT1-IP-POOL-END>
       - Subnet as <RELAY-AGENT1-IP-POOL-SUBNET>
       - Subnet Mask as <RELAY-AGENT1-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: Initialize a DHCP Relay Agent working between ANVL and DUT
        indicating client1 is in a different subnet than any of DUT
        interfaces, so all DHCP Messages sent by emulated client(s)
        will have non-zero 'giaddr' field value
- ANVL: DHCP Client <CLIENT-1> transit state machine to SELECTING
        state
- ANVL: Verify that received DHCPOFFER Message contains:
        - Destination IP Address field is set to <RELAY-1-IP-ADDR>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-5


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:37 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:37 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 5
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |       .........+..........................+                |
  |       .        |<AIface-0>      <DIface-0>|                |
  |<RELAY-AGENT1>  |                          |           DUT  |
  +-------+--------+                          +----------------+
          .N1
          .
<AIface-0>.N1
  +-------+--------+
  |                |
  |                |
  |                |
  |                |
  | <CLIENT-1>     |
  +----------------+


Causing DUT to add a static route on DUT for
Destination Address 59.0.0.0
Gateway Address 30.1.1.150
outgoing interface <DIface-0>
Netmask 255.255.255.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
59.0.0.0 30.1.1.150 0 255.255.255.0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/ip-dut-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -net -netmask 255.255.255.0 59.0.0.0 30.1.1.150
    add net 59.0.0.0: netmask 255.255.255.0: gateway 30.1.1.150
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       5     gei0   0    
30.1.1.5                        30.1.1.5                      UH       4     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
59.0.0.0/24                     30.1.1.150                    UGS      0     gei0   0    
localhost                       localhost                     UH       3112  lo0    0    
128.224.166.0/23                vxTarget                      UC       3848  gei2   0    
vxTarget                        vxTarget                      UH       19687 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       730268lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 59.0.0.11
End IP Address   : 59.0.0.21
Subnet           : 59.0.0.0
Subnet Mask      : 255.255.255.0
for <DIface-2>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2 59.0.0.0 255.255.255.0 59.0.0.11 59.0.0.21 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:59.0.0.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:59.0.0.11
POOL_RANGE_END:59.0.0.21
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 59.0.0.0 255.255.255.0

-> cmd dhcps pool add 59.0.0.0 59.0.0.11 59.0.0.21

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 59.0.0.0        netmask: 255.255.255.0  
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.
Initializing a DHCP Relay Agent working between ANVL and DUT
indicating client1 is in a different subnet than any of DUT
interfaces, so all DHCP Messages sent by emulated client(s)
will have non-zero 'giaddr' field value

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0046 (70)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7998 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x87A9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 1
DHCP: xid                       = 327823387 (0x138A301B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 59.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:37
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xFC6A (64618)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x2334 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 59.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xCF70 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 327823387 (0x138A301B)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 59.0.0.11
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 59.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:37
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 864000 seconds (10 days )
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> successfully transited to SELECTING state

Destination IP Address field in received DHCPOFFER Message is correctly set to 59.0.0.1

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 59.0.0.11
End IP Address   : 59.0.0.21
Subnet           : 59.0.0.0
Subnet Mask      : 255.255.255.0
for <DIface-2>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2 59.0.0.0 255.255.255.0 59.0.0.11 59.0.0.21 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:59.0.0.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:59.0.0.11
POOL_RANGE_END:59.0.0.21
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 59.0.0.11
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:37
Lease time   : 864000 seconds
Expires at   : 1970/01/01 05:38:26 

-> cmd dhcps pool delete 59.0.0.0 59.0.0.11 59.0.0.21

-> cmd dhcps subnet delete 59.0.0.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to delete static route on DUT for
Destination Address 59.0.0.0
Gateway Address 30.1.1.150
outgoing interface <DIface-0>
Netmask 255.255.255.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
59.0.0.0 30.1.1.150 0 255.255.255.0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/ip-dut-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -net 59.0.0.0
    delete net 59.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       5     gei0   0    
30.1.1.5                        30.1.1.5                      UH       4     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       3112  lo0    0    
128.224.166.0/23                vxTarget                      UC       3850  gei2   0    
vxTarget                        vxTarget                      UH       19853 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       735398lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:37 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:37 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-10.5: Passed

>> DHCP-SERVER-10.7
TEST_DESCRIPTION
If 'giaddr' is zero and 'ciaddr' is zero, and the broadcast bit is
set, then the server broadcasts DHCPOFFER and DHCPACK messages to
0xffffffff
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0> containing :
        - 'flags' field set to DHCP_FLAGS_BROADCAST
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Verify that received DHCPOFFER Message contains:
        - Destination IP Address field is set to 0xffffffff
- ANVL:DHCP Client <CLIENT-1> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - 'flags' field set to DHCP_FLAGS_BROADCAST
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPACK Message
- ANVL: Verify that received DHCPACK Message contains:
        - Destination IP Address field is set to 0xffffffff
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:38 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:38 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0> containing :
  - 'flags' field set to DHCP_FLAGS_BROADCAST (10000000 00000000) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:38
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0047 (71)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7997 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xE54C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 310021767 (0x127A8E87)
DHCP: secs                      = 0
DHCP: flags                     = 0x8000 (BROADCAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:38
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5AA0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xC8AC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 310021767 (0x127A8E87)
DHCP: secs                      = 0
DHCP: flags                     = 0x8000 (BROADCAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:38
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

Destination IP Address field in received DHCPOFFER Message is correctly set to 255.255.255.255

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
  - 'flags' field set to DHCP_FLAGS_BROADCAST (10000000 00000000) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:38
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0048 (72)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x798A (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x338E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 310021767 (0x127A8E87)
DHCP: secs                      = 0
DHCP: flags                     = 0x8000 (BROADCAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:38
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5AA0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xC5AC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 310021767 (0x127A8E87)
DHCP: secs                      = 0
DHCP: flags                     = 0x8000 (BROADCAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:38
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPACK Message from <DIface-0>

Destination IP Address field in received DHCPACK Message is correctly set to 255.255.255.255

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:38
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:41:58 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:38
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:41:58 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:38 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:38 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-10.7: Passed

>> DHCP-SERVER-10.8
TEST_DESCRIPTION
If the broadcast bit is not set and 'giaddr' is zero and
'ciaddr' is zero, then the server unicasts DHCPOFFER and DHCPACK
messages to the client's hardware address and 'yiaddr' address
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to SELECTING
        state
- ANVL: Extracts the content of 'yiaddr' field to <extractedYiaddr>
- ANVL: Verify that received DHCPOFFER Message contains:
        - Destination IP Address field is set to extractedYiaddr
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: Verify that received DHCPACK Message contains:
        - Destination IP Address field is set to extractedYiaddr
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:39 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:39 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:39
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0049 (73)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7995 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x8C2F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1656756062 (0x62C0175E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:39
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:39
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x4FEE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1656756062 (0x62C0175E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:39
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> successfully transited to SELECTING state

Extracted the content of 'yiaddr' field (30.1.1.160) to <extractedYiaddr>

Destination IP Address field in received DHCPOFFER Message is correctly set to 30.1.1.160

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:39
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x004A (74)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7988 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0xDA70 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1656756062 (0x62C0175E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:39
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:39
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x4CEE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1656756062 (0x62C0175E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:39
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

Destination IP Address field in received DHCPACK Message is correctly set to 30.1.1.160

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:39
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:42:07 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:39
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:42:07 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:39 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:39 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-10.8: Passed

>> DHCP-SERVER-10.9
TEST_DESCRIPTION
In all cases, when 'giaddr' is zero, the server broadcasts any DHCPNAK
messages to 0xffffffff
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: DHCP Client <CLIENT-2> transit state machine to SELECTING
        state
- ANVL:DHCP Client <CLIENT-2> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Value set to <CLIENT1-IP-ADDRESS>
- ANVL:DHCP Client <CLIENT-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPNAK Message
- ANVL: Verify that received DHCPNAK Message contains:
        - Destination IP Address field is set to 0xffffffff
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:3A for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:3A 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:3C for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:3C 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <CLIENT-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <CLIENT-2>     |
  +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:3A
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x004B (75)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7993 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xF833 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 119277309 (0x071C06FD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:3A
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:3A
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xBBF2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 119277309 (0x071C06FD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:3A
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:3A
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x004C (76)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7986 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x4675 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 119277309 (0x071C06FD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:3A
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:3A
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xB8F2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 119277309 (0x071C06FD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:3A
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:3C
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x004D (77)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7991 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xDAB7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1677117340 (0x63F6C79C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:3C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:3C
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x9E74 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1677117340 (0x63F6C79C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:3C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> successfully transited to SELECTING state

DHCP Client <CLIENT-2> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_REQUESTED_IP_ADDRESS_OPTION     (Requested IP Address) 
  - Value set to <CLIENT1-IP-ADDRESS> (30.1.1.160) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:3C
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x004E (78)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7984 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x7CA5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1677117340 (0x63F6C79C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:3C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPNAK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5AA0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xF685 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1677117340 (0x63F6C79C)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:3C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 56 (Message) ---
DHCP: Length                   = 16
DHCP: Value                    = Invalid address
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-2> received expected DHCPNAK Message from <DIface-0>

Destination IP Address field in received DHCPNAK Message is correctly set to 255.255.255.255

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:3a
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:42:18 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:3c
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:39:08 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:3a
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:42:18 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:3c
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:39:08 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:3A for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:3A 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:3C for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:3C 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-10.9: Passed



>> DHCP-SERVER-10.11
TEST_DESCRIPTION
If the options in a DHCP message extend into the 'sname' and 'file'
fields, the 'option overload' option MUST appear in the 'options'
field, with value 1, 2 or 3
(Note: This test checks option overload for 'sname' field)
TEST_REFERENCE
RFC 2131 Section 4.1 Page 23 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: DHCP Client <CLIENT-2> transit state machine to SELECTING
        state
- ANVL:DHCP Client <CLIENT-2> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'sname' field is used to hold options
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 50 (Requested IP Address Option)
          - Value set to <CLIENT1-IP-ADDRESS>
        - DHCP Message Option in 'sname' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Client <CLIENT-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPNAK Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:40 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:40 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:42 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:42 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <CLIENT-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <CLIENT-2>     |
  +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:40
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0053 (83)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x798B (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x420F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1858033016 (0x6EBF5578)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:40
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:40
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x05CE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1858033016 (0x6EBF5578)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:40
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:40
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0054 (84)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x797E (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x9050 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1858033016 (0x6EBF5578)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:40
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:40
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x02CE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1858033016 (0x6EBF5578)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:40
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:42
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0055 (85)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7989 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xED9D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1266142511 (0x4B77CD2F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:42
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:42
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xB15A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1266142511 (0x4B77CD2F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:42
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> successfully transited to SELECTING state

DHCP Client <CLIENT-2> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_SNAME_HOLDS_OPTION (2'sname' field holds options) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_REQUESTED_IP_ADDRESS_OPTION     (Requested IP Address) 
  - Value set to <CLIENT1-IP-ADDRESS> (30.1.1.160) 
- DHCP Message Option in 'sname' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:42
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0056 (86)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7858 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 556 
UDP: Checksum         = 0x4653 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1266142511 (0x4B77CD2F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:42
DHCP: Server Host containing DHCP Options (START)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 255 (End Option) ---
DHCP: Server Host Name containing DHCP Options (END)
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 2'sname' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPNAK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5AA0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xB8C5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1266142511 (0x4B77CD2F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:42
DHCP: Server Host Name          = 2
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 56 (Message) ---
DHCP: Length                   = 16
DHCP: Value                    = Invalid address
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-2> received expected DHCPNAK Message from <DIface-0>

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:40
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:42:51 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:42
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:39:41 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:40
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:42:51 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:42
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:39:41 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:40 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:40 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:42 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:42 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-10.11: Passed

>> DHCP-SERVER-10.14
TEST_DESCRIPTION
The options in the 'sname' and 'file' fields (if in use as indicated
by the 'options overload' option) MUST begin with the first octet of
the field
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: DHCP Client <CLIENT-2> transit state machine to SELECTING
        state
- ANVL:DHCP Client <CLIENT-2> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 50 (Requested IP Address Option)
          - Value set to <CLIENT1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Client <CLIENT-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPNAK Message
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: DHCP Client <CLIENT-2> transit state machine to SELECTING
        state
- ANVL:DHCP Client <CLIENT-2> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 0 (Pad Option)(*INVALID*)
        - DHCP Message Option in 'file' field containing:
          - Type field set to 50 (Requested IP Address Option)
          - Value set to <CLIENT1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Client <CLIENT-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send DHCPNAK Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:43 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:43 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:45 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:45 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <CLIENT-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <CLIENT-2>     |
  +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:43
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0057 (87)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7987 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xE753 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1030087050 (0x3D65E18A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:43
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:43
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xAB12 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1030087050 (0x3D65E18A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:43
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:43
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0058 (88)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x797A (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x3595 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1030087050 (0x3D65E18A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:43
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:43
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xA812 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1030087050 (0x3D65E18A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:43
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:45
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0059 (89)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7985 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xD07A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 427170897 (0x19761C51)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:45
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:45
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x9437 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 427170897 (0x19761C51)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:45
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> successfully transited to SELECTING state

DHCP Client <CLIENT-2> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_REQUESTED_IP_ADDRESS_OPTION     (Requested IP Address) 
  - Value set to <CLIENT1-IP-ADDRESS> (30.1.1.160) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:45
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x005A (90)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7854 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 556 
UDP: Checksum         = 0x2A30 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 427170897 (0x19761C51)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:45
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPNAK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5AA0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x9BA2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 427170897 (0x19761C51)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:45
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = 2
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 56 (Message) ---
DHCP: Length                   = 16
DHCP: Value                    = Invalid address
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-2> received expected DHCPNAK Message from <DIface-0>

Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:43
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:43:02 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:45
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:39:52 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

failed :: already exists
-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

failed :: invalid config
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:43
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:43:02 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:45
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:39:52 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:43
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:43:02 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:45
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:39:52 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:43
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:43:02 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:45
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:39:52 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> successfully transited to BOUND state

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:45
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x005B (91)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7853 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 556 
UDP: Checksum         = 0xCE1A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 427170897 (0x19761C51)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:45
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:45
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x9437 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 427170897 (0x19761C51)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:45
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> successfully transited to SELECTING state

DHCP Client <CLIENT-2> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_PAD_OPTION(*INVALID*)     (Pad Option) 
- DHCP Message Option in 'file' field containing:
  - Type field set to     DHCP_REQUESTED_IP_ADDRESS_OPTION (Requested IP Address) 
  - Value set to <CLIENT1-IP-ADDRESS> (30.1.1.160) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:45
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x005C (92)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7852 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 556 
UDP: Checksum         = 0xD485 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 427170897 (0x19761C51)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:45
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 0 (Pad Option) ---
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for no DHCPNAK Message on <DIface-0>

DHCP Client <CLIENT-2> correctly did not receive DHCPNAK Message from <DIface-0>

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:43
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:43:02 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

failed :: not found
-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:43 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:43 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:45 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:45 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-10.14: Passed

>> DHCP-SERVER-10.15
TEST_DESCRIPTION
The options in the 'sname' and 'file' fields (if in use as indicated
 ...)
MUST be terminated by an 'end' option
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: DHCP Client <CLIENT-2> transit state machine to SELECTING
        state
- ANVL:DHCP Client <CLIENT-2> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 50 (Requested IP Address Option)
          - Value set to <CLIENT1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Client <CLIENT-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPNAK Message
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: DHCP Client <CLIENT-2> transit state machine to SELECTING
        state
- ANVL:DHCP Client <CLIENT-2> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 50 (Requested IP Address Option)
          - Value set to <CLIENT1-IP-ADDRESS>
- ANVL:DHCP Client <CLIENT-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send DHCPNAK Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:46 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:46 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:48 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:48 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <CLIENT-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <CLIENT-2>     |
  +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:46
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x005D (93)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7981 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x5B43 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 346986063 (0x14AE964F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:46
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:46
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x1F02 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 346986063 (0x14AE964F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:46
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:46
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x005E (94)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7974 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0xA984 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 346986063 (0x14AE964F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:46
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:46
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x1C02 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 346986063 (0x14AE964F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:46
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:48
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x005F (95)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x797F (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x0EE3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1900905998 (0x714D860E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:48
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:48
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xD29F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1900905998 (0x714D860E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:48
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> successfully transited to SELECTING state

DHCP Client <CLIENT-2> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_REQUESTED_IP_ADDRESS_OPTION     (Requested IP Address) 
  - Value set to <CLIENT1-IP-ADDRESS> (30.1.1.160) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:48
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0060 (96)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x784E (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 556 
UDP: Checksum         = 0x6898 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1900905998 (0x714D860E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:48
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPNAK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5AA0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xDA0A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1900905998 (0x714D860E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:48
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = 2
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 56 (Message) ---
DHCP: Length                   = 16
DHCP: Value                    = Invalid address
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-2> received expected DHCPNAK Message from <DIface-0>

Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:46
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:46:42 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:48
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:43:32 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

failed :: already exists
-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

failed :: invalid config
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:46
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:46:42 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:48
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:43:32 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:46
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:46:42 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:48
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:43:32 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:46
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:46:42 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:48
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:43:32 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> successfully transited to BOUND state

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:48
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0061 (97)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x784D (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 556 
UDP: Checksum         = 0x0C83 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1900905998 (0x714D860E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:48
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:48
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xD29F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1900905998 (0x714D860E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:48
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> successfully transited to SELECTING state

DHCP Client <CLIENT-2> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to     DHCP_REQUESTED_IP_ADDRESS_OPTION (Requested IP Address) 
  - Value set to <CLIENT1-IP-ADDRESS> (30.1.1.160) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:48
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0062 (98)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x784C (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 556 
UDP: Checksum         = 0x6799 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1900905998 (0x714D860E)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:48
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for no DHCPNAK Message on <DIface-0>

DHCP Client <CLIENT-2> correctly did not receive DHCPNAK Message from <DIface-0>

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:46
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:46:42 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

failed :: not found
-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:46 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:46 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:48 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:48 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-10.15: Passed

>> DHCP-SERVER-10.16
TEST_DESCRIPTION
The options in the 'sname' and 'file' fields (if in use as indicated ...
and MUST be followed by 'pad' options to fill the remainder of the field
TEST_REFERENCE
NEGATIVE
RFC 2131 Section 4.1 Page 24 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: DHCP Client <CLIENT-2> transit state machine to SELECTING
        state
- ANVL:DHCP Client <CLIENT-2> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 50 (Requested IP Address Option)
          - Value set to <CLIENT1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
- ANVL:DHCP Client <CLIENT-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPNAK Message
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: DHCP Client <CLIENT-2> transit state machine to SELECTING
        state
- ANVL:DHCP Client <CLIENT-2> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - Additional PAD Options to make packet length set to 576
        - Message Option containing:
          - Type field set to 52 (Overload Option)
          - Length field set to 1
          - Value set to the 'file' field is used to hold options
        - DHCP Message Option in 'file' field containing:
          - Type field set to 50 (Requested IP Address Option)
          - Value set to <CLIENT1-IP-ADDRESS>
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)
        - DHCP Message Option in 'file' field containing:
          - Type field set to 0 (Pad Option)(*INVALID*)
        - DHCP Message Option in 'file' field containing:
          - Type field set to 255 (End Option)(*INVALID*)
- ANVL:DHCP Client <CLIENT-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send DHCPNAK Message
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:49 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:49 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:4B for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:4B 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <CLIENT-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <CLIENT-2>     |
  +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:49
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0063 (99)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x797B (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x2A51 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 503299565 (0x1DFFBDED)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:49
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:49
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xEE0F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 503299565 (0x1DFFBDED)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:49
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:49
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0064 (100)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x796E (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x7892 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 503299565 (0x1DFFBDED)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:49
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:49
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xEB0F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 503299565 (0x1DFFBDED)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:49
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:4B
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0065 (101)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7979 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x384C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1745708514 (0x680D65E2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:4B
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:4B
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xFC08 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1745708514 (0x680D65E2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:4B
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> successfully transited to SELECTING state

DHCP Client <CLIENT-2> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length set to     576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_REQUESTED_IP_ADDRESS_OPTION     (Requested IP Address) 
  - Value set to <CLIENT1-IP-ADDRESS> (30.1.1.160) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:4B
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0066 (102)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7848 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 556 
UDP: Checksum         = 0x9201 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1745708514 (0x680D65E2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:4B
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPNAK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5AA0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x0374 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1745708514 (0x680D65E2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:4B
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = 2
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 56 (Message) ---
DHCP: Length                   = 16
DHCP: Value                    = Invalid address
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-2> received expected DHCPNAK Message from <DIface-0>

Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:49
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:50:32 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:4b
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:47:22 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

failed :: already exists
-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

failed :: invalid config
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:49
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:50:32 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:4b
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:47:22 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:49
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:50:32 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:4b
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:47:22 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:49
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:50:32 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:4b
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:47:22 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> successfully transited to BOUND state

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:4B
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0067 (103)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7847 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 556 
UDP: Checksum         = 0x35EC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1745708514 (0x680D65E2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:4B
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:4B
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xFC08 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1745708514 (0x680D65E2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:4B
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> successfully transited to SELECTING state

DHCP Client <CLIENT-2> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
  - Additional PAD Options to make packet length     set to 576 (576) 
- Message Option containing:
  - Type field set to DHCP_OVERLOAD_OPTION (Overload) 
  - Length field set to 1 (1) 
  - Value set to DHCP_FILE_HOLDS_OPTION (1'file' field holds options) 
- DHCP Message Option in 'file' field containing:
  - Type field set to     DHCP_REQUESTED_IP_ADDRESS_OPTION (Requested IP Address) 
  - Value set to <CLIENT1-IP-ADDRESS> (30.1.1.160) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION (End Option) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_PAD_OPTION(*INVALID*)     (Pad Option) 
- DHCP Message Option in 'file' field containing:
  - Type field set to DHCP_END_OPTION(*INVALID*)     (End Option) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:4B
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 576 bytes
IP: Identification         = 0x0068 (104)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7846 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 556 
UDP: Checksum         = 0x9300 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1745708514 (0x680D65E2)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:4B
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name containing DHCP Options (START)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 255 (End Option) ---
DHCP: --- Option 0 (Pad Option) ---
DHCP: --- Option 255 (End Option) ---
DHCP: Boot File Name containing DHCP Options (END)
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 52 (Overload) ---
DHCP: Length                   = 1
DHCP: Value                    = 1'file' field holds options
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for no DHCPNAK Message on <DIface-0>

DHCP Client <CLIENT-2> correctly did not receive DHCPNAK Message from <DIface-0>

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:49
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:50:32 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

failed :: not found
-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:49 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:49 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:4B for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:4B 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-10.16: Passed

>> DHCP-SERVER-10.17
TEST_DESCRIPTION
A server or relay agent sending or relaying a DHCP message directly
to a DHCP client (i.e., not to a relay agent specified in the
'giaddr' field) SHOULD examine the BROADCAST bit in the 'flags'
field.  If this bit is set to 1, the DHCP message SHOULD be sent as
an IP broadcast using an IP broadcast address (preferably 0xffffffff)
as the IP destination address and the link-layer broadcast address as
the link-layer destination address
(Note: This test is to verify the destination link local address of
       the received DHCP Messages from the DUT)
TEST_REFERENCE
RFC 2131 Section 4.1 Page 25 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0> containing :
        - 'flags' field set to DHCP_FLAGS_BROADCAST
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Verify that received DHCPOFFER Message contains:
        - Destination Harware Address field is set to
           <LINK-LAYER-BROADCAST-ADDR>
- ANVL:DHCP Client <CLIENT-1> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - 'flags' field set to DHCP_FLAGS_BROADCAST
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPACK Message
- ANVL: Verify that received DHCPACK Message contains:
        - Destination Harware Address field is set to
           <LINK-LAYER-BROADCAST-ADDR>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:4C for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:4C 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0> containing :
  - 'flags' field set to DHCP_FLAGS_BROADCAST (10000000 00000000) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:4C
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0069 (105)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7975 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x604A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 252516067 (0x0F0D16E3)
DHCP: secs                      = 0
DHCP: flags                     = 0x8000 (BROADCAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:4C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5AA0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x43AA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 252516067 (0x0F0D16E3)
DHCP: secs                      = 0
DHCP: flags                     = 0x8000 (BROADCAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:4C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

Destination Harware Address field in received DHCPOFFER Message is correctly set to FF:FF:FF:FF:FF:FF

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
  - 'flags' field set to DHCP_FLAGS_BROADCAST (10000000 00000000) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:4C
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x006A (106)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7968 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0xAE8B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 252516067 (0x0F0D16E3)
DHCP: secs                      = 0
DHCP: flags                     = 0x8000 (BROADCAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:4C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5AA0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x40AA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 252516067 (0x0F0D16E3)
DHCP: secs                      = 0
DHCP: flags                     = 0x8000 (BROADCAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:4C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPACK Message from <DIface-0>

Destination Harware Address field in received DHCPACK Message is correctly set to FF:FF:FF:FF:FF:FF

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:4c
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:54:10 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:4c
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:54:10 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:4C for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:4C 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-10.17: Passed

>> DHCP-SERVER-10.18
TEST_DESCRIPTION
If the BROADCAST bit is cleared to 0, the message SHOULD be sent as an
IP unicast to the IP address specified in the 'yiaddr' field and the
link-layer address specified in the 'chaddr' field
TEST_REFERENCE
RFC 2131 Section 4.1 Page 25 'Constructing and sending DHCP messages'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0> containing :
        - 'flags' field set to 0
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Extracts the content of 'yiaddr' field to <extractedYiaddr>
- ANVL: Extracts the content of 'chaddr' field to <extractedChaddr>
- ANVL: Verify that received DHCPOFFER Message contains:
        - Destination Harware Address field is set to extractedChaddr
        - Destination IP Address field is set to extractedYiaddr
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:4D for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:4D 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0> containing :
  - 'flags' field set to 0 (00000000 00000000) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:4D
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x006B (107)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7973 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x764B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 464811066 (0x1BB4743A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:4D
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:4D
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x3A0A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 464811066 (0x1BB4743A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:4D
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

Extracted the content of 'yiaddr' field (30.1.1.160) to <extractedYiaddr>

Extracted the content of 'chaddr' field (02:02:00:00:00:4D) to <extractedChaddr>

Destination Harware Address field in received DHCPOFFER Message is correctly set to 02:02:00:00:00:4D

Destination IP Address field in received DHCPOFFER Message is correctly set to 30.1.1.160

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:4d
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:51:19 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:4d
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:51:19 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:4D for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:4D 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
exit
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-10.18: Passed

>> DHCP-SERVER-11.2
TEST_DESCRIPTION
If the client does not provide a 'client identifier' option, the server
MUST use the contents of the 'chaddr' field to identify the client
TEST_REFERENCE
RFC 2131 Section 4.2 Page 26 'DHCP server administrative controls'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: Wait till <ParamProcessTime> for DUT to complete the
        activation of DHCP session
- ANVL: Extracts the content of 'yiaddr' field to <extractedYiaddr>
- ANVL: DHCP Client <CLIENT-2> transit state machine to SELECTING
        state
- ANVL: Verify that received DHCPOFFER Message contains:
        - 'yiaddr' field is not set to extractedYiaddr
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:4E for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:4E 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:50 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:50 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <CLIENT-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <CLIENT-2>     |
  +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:4E
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x006C (108)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7972 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x7FC6 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1152139718 (0x44AC41C6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:4E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:4E
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x4385 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1152139718 (0x44AC41C6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:4E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:4E
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x006D (109)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7965 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0xCE07 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1152139718 (0x44AC41C6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:4E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:4E
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x4085 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1152139718 (0x44AC41C6)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:4E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

Waiting (up to 2.000 seconds) for DUT to complete the activation of DHCP session

Extracted the content of 'yiaddr' field (30.1.1.160) to <extractedYiaddr>

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:50
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x006E (110)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7970 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x59CE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1634421501 (0x616B4AFD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:50
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:50
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x1D8B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1634421501 (0x616B4AFD)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:50
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> successfully transited to SELECTING state

'yiaddr' field in received DHCPOFFER Message is correctly set to 30.1.1.161 (not set to 30.1.1.160)

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:4e
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:54:50 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:50
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:51:42 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:4e
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:54:50 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:50
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:51:42 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:4E for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:4E 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:50 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:50 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-11.2: Passed

>> DHCP-SERVER-12.2
TEST_DESCRIPTION
o The client's previous address as recorded in the client's (now
   expired or released) binding, if that address is in the server's
   pool of available addresses and not already allocated, 
TEST_REFERENCE
RFC 2131 Section 4.3.1 Page 27 'DHCPDISCOVER message'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: Extracts the content of 'yiaddr' field to <extractedYiaddr>
- ANVL: Wait till <ParamProcessTime> for DUT to complete the
        activation of DHCP session
- ANVL: DHCP Client <CLIENT-1> sends DHCPRELEASE Message to DUT
        through <DIface-0>
- ANVL: Wait till <ParamProcessTime> for DUT to process the
        DHCPRELEASE Message
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Verify that received DHCPOFFER Message contains:
        - 'yiaddr' field is set to extractedYiaddr
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:51 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:51 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:51
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x006F (111)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x796F (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xFC43 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 884725046 (0x34BBD536)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:51
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:51
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xC002 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 884725046 (0x34BBD536)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:51
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:51
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0070 (112)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7962 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x4A85 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 884725046 (0x34BBD536)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:51
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:51
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xBD02 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 884725046 (0x34BBD536)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:51
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

Extracted the content of 'yiaddr' field (30.1.1.160) to <extractedYiaddr>

Waiting (up to 2.000 seconds) for DUT to complete the activation of DHCP session

DHCP Client <CLIENT-1> sending DHCPRELEASE Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 02:02:00:00:00:51
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x0071 (113)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AC0 (Correct)
IP: Source Address         = 30.1.1.160
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 258 
UDP: Checksum         = 0x8D9A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 884725046 (0x34BBD536)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.160
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:51
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 7 (DHCPRELEASE)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Waiting (up to 2.000 seconds) for DUT to process the DHCPRELEASE Message

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:51
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0072 (114)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x796C (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xFC43 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 884725046 (0x34BBD536)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:51
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:51
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xC002 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 884725046 (0x34BBD536)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:51
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

'yiaddr' field in received DHCPOFFER Message is correctly set to 30.1.1.160

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:51
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:52:06 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:51
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:52:06 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:51 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:51 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-12.2: Passed

>> DHCP-SERVER-12.3
TEST_DESCRIPTION
o The address requested in the 'Requested IP Address' option, if that
  address is valid and not already allocated, 
TEST_REFERENCE
RFC 2131 Section 4.3.1 Page 27 'DHCPDISCOVER message'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0> containing :
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Length field set to 4
          - Value set to (<DUT-SERVER-0-IP-POOL-START>+1)
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Verify that received DHCPOFFER Message contains:
        - 'yiaddr' field is set to (<DUT-SERVER-0-IP-POOL-START>+1)
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:52 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:52 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_REQUESTED_IP_ADDRESS_OPTION     (Requested IP Address) 
  - Length field set to 4 (4) 
  - Value set to (<DUT-SERVER-0-IP-POOL-START>+1) (30.1.1.161) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:52
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x0073 (115)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7965 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 258 
UDP: Checksum         = 0x233E (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 138840318 (0x084688FE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:52
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.161
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:52
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x38AD (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 138840318 (0x084688FE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:52
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

'yiaddr' field in received DHCPOFFER Message is correctly set to 30.1.1.161

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:52
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:52:26 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.161
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:52
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:52:26 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:52 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:52 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-12.3: Passed

>> DHCP-SERVER-12.4
TEST_DESCRIPTION
o A new address allocated from the server's pool of available
  addresses; the address is selected based on the subnet from which
  the message was received (if 'giaddr' is 0)
TEST_REFERENCE
RFC 2131 Section 4.3.1 Page 27 'DHCPDISCOVER message'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Verify that received DHCPOFFER Message contains:
        - Subnet Address of 'yiaddr' field  is set to 
           <DIface-0-SUBNET>
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:53 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:53 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:53
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0074 (116)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x796A (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x3D16 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2026197080 (0x78C55058)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:53
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:53
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x00D5 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 2026197080 (0x78C55058)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:53
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

Received DHCPOFFER Message correctly contains:
- Subnet Address of 'yiaddr' field correctly set to 30.1.1.0

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:53
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:52:45 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:53
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:52:45 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:53 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:53 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-12.4: Passed

>> DHCP-SERVER-12.5
TEST_DESCRIPTION
o A new address allocated from the server's pool of available ...
or on the address of the relay agent that forwarded the message
('giaddr' when not 0)
TEST_REFERENCE
RFC 2131 Section 4.3.1 Page 27 'DHCPDISCOVER message'
TEST_METHOD
 SETUP: Configure DUT to add static route for network
        <RELAY-AGENT1-IP-POOL-SUBNET>
        (mask <RELAY-AGENT1-IP-POOL-SUBNETMASK>) using gateway
         <AIface-0-IP-ADDRESS> through <DIface-0>
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <RELAY-AGENT1-IP-POOL-START>
       - End of pool as <RELAY-AGENT1-IP-POOL-END>
       - Subnet as <RELAY-AGENT1-IP-POOL-SUBNET>
       - Subnet Mask as <RELAY-AGENT1-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: Initialize a DHCP Relay Agent working between ANVL and DUT
        indicating client1 is in a different subnet than any of DUT
        interfaces, so all DHCP Messages sent by emulated client(s)
        will have non-zero 'giaddr' field value
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Verify that received DHCPOFFER Message contains:
        - Subnet Address of 'yiaddr' field  is set to 
           <RELAY-AGENT1-IP-POOL-SUBNET>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-5


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:54 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:54 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 5
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |       .........+..........................+                |
  |       .        |<AIface-0>      <DIface-0>|                |
  |<RELAY-AGENT1>  |                          |           DUT  |
  +-------+--------+                          +----------------+
          .N1
          .
<AIface-0>.N1
  +-------+--------+
  |                |
  |                |
  |                |
  |                |
  | <CLIENT-1>     |
  +----------------+


Causing DUT to add a static route on DUT for
Destination Address 60.0.0.0
Gateway Address 30.1.1.150
outgoing interface <DIface-0>
Netmask 255.255.255.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
60.0.0.0 30.1.1.150 0 255.255.255.0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/ip-dut-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -net -netmask 255.255.255.0 60.0.0.0 30.1.1.150
    add net 60.0.0.0: netmask 255.255.255.0: gateway 30.1.1.150
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       5     gei0   0    
30.1.1.5                        30.1.1.5                      UH       5     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
60.0.0.0/24                     30.1.1.150                    UGS      0     gei0   0    
localhost                       localhost                     UH       3112  lo0    0    
128.224.166.0/23                vxTarget                      UC       3975  gei2   0    
vxTarget                        vxTarget                      UH       22285 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       789020lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 60.0.0.11
End IP Address   : 60.0.0.21
Subnet           : 60.0.0.0
Subnet Mask      : 255.255.255.0
for <DIface-2>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2 60.0.0.0 255.255.255.0 60.0.0.11 60.0.0.21 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:60.0.0.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:60.0.0.11
POOL_RANGE_END:60.0.0.21
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 60.0.0.0 255.255.255.0

-> cmd dhcps pool add 60.0.0.0 60.0.0.11 60.0.0.21

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 60.0.0.0        netmask: 255.255.255.0  
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.
Initializing a DHCP Relay Agent working between ANVL and DUT
indicating client1 is in a different subnet than any of DUT
interfaces, so all DHCP Messages sent by emulated client(s)
will have non-zero 'giaddr' field value

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0075 (117)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7969 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x3EB0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 1
DHCP: xid                       = 440168773 (0x1A3C7145)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 60.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:54
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x3838 (14392)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xE666 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 60.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x8477 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 440168773 (0x1A3C7145)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 60.0.0.11
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 60.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:54
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 864000 seconds (10 days )
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

Received DHCPOFFER Message correctly contains:
- Subnet Address of 'yiaddr' field correctly set to 60.0.0.0

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 60.0.0.11
End IP Address   : 60.0.0.21
Subnet           : 60.0.0.0
Subnet Mask      : 255.255.255.0
for <DIface-2>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2 60.0.0.0 255.255.255.0 60.0.0.11 60.0.0.21 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:60.0.0.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:60.0.0.11
POOL_RANGE_END:60.0.0.21
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 60.0.0.11
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:54
Lease time   : 864000 seconds
Expires at   : 1970/01/01 05:52:57 

-> cmd dhcps pool delete 60.0.0.0 60.0.0.11 60.0.0.21

-> cmd dhcps subnet delete 60.0.0.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to delete static route on DUT for
Destination Address 60.0.0.0
Gateway Address 30.1.1.150
outgoing interface <DIface-0>
Netmask 255.255.255.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
60.0.0.0 30.1.1.150 0 255.255.255.0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/ip-dut-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -net 60.0.0.0
    delete net 60.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       5     gei0   0    
30.1.1.5                        30.1.1.5                      UH       5     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       3112  lo0    0    
128.224.166.0/23                vxTarget                      UC       3979  gei2   0    
vxTarget                        vxTarget                      UH       22453 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       794476lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:54 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:54 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-12.5: Passed

>> DHCP-SERVER-12.7
TEST_DESCRIPTION
The server must also choose an expiration time for the lease, as
follows:
o IF the client has not requested a specific lease in the
  DHCPDISCOVER message and the client does not have an assigned
  network address, the server assigns a locally configured default
  lease time. 
TEST_REFERENCE
RFC 2131 Section 4.3.1 Page 28 'DHCPDISCOVER message'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Verify that received DHCPOFFER Message contains:
        - Message Option containing:
          - Type field is not set to 51 (IP Address Lease Time Option)
          - Length field is not set to 4
          - Value is not set to 0
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:55 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:55 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:55
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0076 (118)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7968 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x0285 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 397339646 (0x17AEEBFE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:55
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:55
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xC643 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 397339646 (0x17AEEBFE)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:55
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

Message Option in received DHCPOFFER Message correctly contains Option IP Address Lease Time (51) Length : 4 Value : 200 seconds (3 minutes 20 seconds) 
(not containing option IP Address Lease Time (51) Length : 4 Value : 0 seconds )

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:55
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:53:19 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:55
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:53:19 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:55 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:55 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-12.7: Passed

>> DHCP-SERVER-12.9
TEST_DESCRIPTION
The server MUST return to the client:
o Parameters requested by the client, according to the following
  rules:
  -- IF the server has been explicitly configured ...
     ELSE
  -- IF the server recognizes the parameter as ...
     ELSE
  -- The server MUST NOT return a value for that parameter,
(Note: In this test we verify the last ELSE statement by requesting 150
       as a vendor specific option)
TEST_REFERENCE
RFC 2131 Section 4.3.1 Page 29 'DHCPDISCOVER message'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0> containing :
        - Message Option containing:
          - Type field set to 55 (Parameter Request List Option)
          - Length field set to 1
          - Value set to 150
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Verify that received DHCPOFFER Message contains:
        - Message Option containing:
          - Type field is not set to 150
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:56 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:56 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_PARAM_REQ_LIST_OPTION (Parameter Request List) 
  - Length field set to 1 (1) 
  - Value set to 150 (
150 = * Unsupported *
) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:56
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 275 bytes
IP: Identification         = 0x0077 (119)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7964 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 255 
UDP: Checksum         = 0x75FF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 332129831 (0x13CBE627)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:56
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 1
DHCP: 150 = * Unsupported *
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:56
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xD4FC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 332129831 (0x13CBE627)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:56
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

Message Option in received DHCPOFFER Message correctly does not contain Option * Unsupported * (150) 

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:56
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:53:28 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:56
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:53:28 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:56 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:56 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-12.9: Passed

>> DHCP-SERVER-12.11
TEST_DESCRIPTION
The server MUST include each requested parameter only once
TEST_REFERENCE
RFC 2131 Section 4.3.1 Page 30 'DHCPDISCOVER message'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0> containing :
        - Message Option containing:
          - Type field set to 55 (Parameter Request List Option)
          - Length field set to 3
          - Value set to 57 (Maximum DHCP Size Option)
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Verify that received DHCPOFFER Message contains:
        - Message Option containing:
          - All the DHCP Message options occurring exactly once
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:57 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:57 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_PARAM_REQ_LIST_OPTION (Parameter Request List) 
  - Length field set to 3 (3) 
  - Value set to DHCP_MAXIMUM_DHCP_SIZE_OPTION (
 57 = Maximum DHCP Size
  1 = Subnet Mask
 51 = IP Address Lease Time
) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:57
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 277 bytes
IP: Identification         = 0x0078 (120)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7961 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 257 
UDP: Checksum         = 0xB8EC (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1334481267 (0x4F8A9173)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:57
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 55 (Parameter Request List) ---
DHCP: Length                   = 3
DHCP:  57 = Maximum DHCP Size
DHCP:   1 = Subnet Mask
DHCP:  51 = IP Address Lease Time
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:57
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xE8F0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1334481267 (0x4F8A9173)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:57
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

All the DHCP Message options
in received DHCPOFFER Message
 is correctly set as follows: 
  Option Message Type occuring exactly 1 time(s)
  Option IP Address Lease Time occuring exactly 1 time(s)
  Option Server Identifier occuring exactly 1 time(s)
  Option Subnet Mask occuring exactly 1 time(s)
  Option End Option occuring exactly 1 time(s)


Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:57
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:53:47 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:57 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:57 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-12.11: Passed

>> DHCP-SERVER-12.13
TEST_DESCRIPTION
The server inserts the 'xid' field from the DHCPDISCOVER message into
the 'xid' field of the DHCPOFFER message and sends the DHCPOFFER
message to the requesting client.
TEST_REFERENCE
RFC 2131 Section 4.3.1 Page 30 'DHCPDISCOVER message'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0> containing :
        - 'xid' field set to 1000
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Verify that received DHCPOFFER Message contains:
        - 'xid' field is set to 1000
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:58 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:58 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0> containing :
  - 'xid' field set to 1000 (0x000003E8) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:58
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0079 (121)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7965 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x0247 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1000 (0x000003E8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:58
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:58
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xC605 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1000 (0x000003E8)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:58
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

'xid' field in received DHCPOFFER Message is correctly set to 1000 (0x000003E8)

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:58
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:54:07 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:58
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:54:07 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:58 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:58 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-12.13: Passed

>> DHCP-SERVER-13.1
TEST_DESCRIPTION
o DHCPREQUEST generated during INIT-REBOOT state:
  Server SHOULD send a DHCPNAK message to the client if the 'requested
  IP address' is incorrect, or is on the wrong network
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 31 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Configure DUT to add static route for network
        <RELAY-AGENT1-IP-POOL-SUBNET>
        (mask <RELAY-AGENT1-IP-POOL-SUBNETMASK>) using gateway
         <AIface-0-IP-ADDRESS> through <DIface-0>
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <RELAY-AGENT1-IP-POOL-START>
       - End of pool as <RELAY-AGENT1-IP-POOL-END>
       - Subnet as <RELAY-AGENT1-IP-POOL-SUBNET>
       - Subnet Mask as <RELAY-AGENT1-IP-POOL-SUBNETMASK>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to INIT-REBOOT
        state
- ANVL: Initialize a DHCP Relay Agent working between ANVL and DUT
        indicating client1 is in a different subnet than any of DUT
        interfaces, so all DHCP Messages sent by emulated client(s)
        will have non-zero 'giaddr' field value
- ANVL:DHCP Client <CLIENT-1> Sends DHCPREQUEST Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPNAK Message
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-5


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:59 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:59 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 5
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |       .........+..........................+                |
  |       .        |<AIface-0>      <DIface-0>|                |
  |<RELAY-AGENT1>  |                          |           DUT  |
  +-------+--------+                          +----------------+
          .N1
          .
<AIface-0>.N1
  +-------+--------+
  |                |
  |                |
  |                |
  |                |
  | <CLIENT-1>     |
  +----------------+


Causing DUT to add a static route on DUT for
Destination Address 61.0.0.0
Gateway Address 30.1.1.150
outgoing interface <DIface-0>
Netmask 255.255.255.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
61.0.0.0 30.1.1.150 0 255.255.255.0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/ip-dut-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -net -netmask 255.255.255.0 61.0.0.0 30.1.1.150
    add net 61.0.0.0: netmask 255.255.255.0: gateway 30.1.1.150
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       6     gei0   0    
30.1.1.5                        30.1.1.5                      UH       5     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
61.0.0.0/24                     30.1.1.150                    UGS      0     gei0   0    
localhost                       localhost                     UH       3112  lo0    0    
128.224.166.0/23                vxTarget                      UC       3994  gei2   0    
vxTarget                        vxTarget                      UH       23057 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       808076lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 61.0.0.11
End IP Address   : 61.0.0.21
Subnet           : 61.0.0.0
Subnet Mask      : 255.255.255.0
for <DIface-2>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2 61.0.0.0 255.255.255.0 61.0.0.11 61.0.0.21 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:61.0.0.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:61.0.0.11
POOL_RANGE_END:61.0.0.21
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 61.0.0.0 255.255.255.0

-> cmd dhcps pool add 61.0.0.0 61.0.0.11 61.0.0.21

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 61.0.0.0        netmask: 255.255.255.0  
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:59
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x007A (122)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7964 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x2697 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1572831703 (0x5DBF81D7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:59
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:59
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xEA55 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1572831703 (0x5DBF81D7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:59
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:59
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x007B (123)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7957 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x74D8 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1572831703 (0x5DBF81D7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:59
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:59
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xE755 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1572831703 (0x5DBF81D7)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:59
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to INIT-REBOOT state
Initializing a DHCP Relay Agent working between ANVL and DUT
indicating client1 is in a different subnet than any of DUT
interfaces, so all DHCP Messages sent by emulated client(s)
will have non-zero 'giaddr' field value

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x007C (124)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x795C (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 258 
UDP: Checksum         = 0xFED9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 1
DHCP: xid                       = 1545848529 (0x5C23C6D1)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 61.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:59
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPNAK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0xAB47 (43847)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7257 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 61.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0x0505 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1545848529 (0x5C23C6D1)
DHCP: secs                      = 0
DHCP: flags                     = 0x8000 (BROADCAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 61.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:59
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 56 (Message) ---
DHCP: Length                   = 16
DHCP: Value                    = Invalid address
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPNAK Message from <DIface-0>

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 61.0.0.11
End IP Address   : 61.0.0.21
Subnet           : 61.0.0.0
Subnet Mask      : 255.255.255.0
for <DIface-2>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2 61.0.0.0 255.255.255.0 61.0.0.11 61.0.0.21 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:61.0.0.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:61.0.0.11
POOL_RANGE_END:61.0.0.21
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:59
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:57:39 

-> cmd dhcps pool delete 61.0.0.0 61.0.0.11 61.0.0.21

-> cmd dhcps subnet delete 61.0.0.0

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:59
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:57:39 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:59
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:57:39 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:59
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:57:39 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to delete static route on DUT for
Destination Address 61.0.0.0
Gateway Address 30.1.1.150
outgoing interface <DIface-0>
Netmask 255.255.255.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
61.0.0.0 30.1.1.150 0 255.255.255.0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/ip-dut-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -net 61.0.0.0
    delete net 61.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       6     gei0   0    
30.1.1.5                        30.1.1.5                      UH       5     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       3112  lo0    0    
128.224.166.0/23                vxTarget                      UC       3997  gei2   0    
vxTarget                        vxTarget                      UH       23227 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       813676lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:59 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:59 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-13.1: Passed

>> DHCP-SERVER-13.2
TEST_DESCRIPTION
If 'giaddr' is 0x0 in the DHCPREQUEST message, the client is on
the same subnet as the server.  The server MUST broadcast the
DHCPNAK message to the 0xffffffff broadcast address
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: DHCP Client <CLIENT-2> transit state machine to INIT-REBOOT
        state
- ANVL:DHCP Client <CLIENT-2> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - Message Option containing:
          - Type field set to 50 (Requested IP Address Option)
          - Value set to <CLIENT1-IP-ADDRESS>
- ANVL:DHCP Client <CLIENT-2> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPNAK Message
- ANVL: Verify that received DHCPNAK Message contains:
        - Destination IP Address field is set to 0xffffffff
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-3


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:5A for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:5A 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:5C for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:5C 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 3
  ---------------------------------------

  +----------------+
  |                |
  |                |N0
  |                +------------+
  |                |<AIface-0>  |
  | <CLIENT-1>     |            |
  +----------------+            |
                                |            +----------------+
                              +-+--+         |                |
                              |    |       N0|                |
                              |HUB +---------+ <DIface-0>     |
                              |    |         |                |
                              +-+--+         |           DUT  |
                                |            +----------------+
  +----------------+            |
  |                |            |
  |                |N0          |
  |                +------------+
  |                |<AIface-0>
  | <CLIENT-2>     |
  +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:5A
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x007D (125)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7961 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x5B92 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1098082599 (0x41736927)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5A
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:5A
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x1F51 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1098082599 (0x41736927)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5A
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:5A
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x007E (126)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7954 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0xA9D3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1098082599 (0x41736927)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5A
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:5A
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x1C51 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1098082599 (0x41736927)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5A
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

DHCP Client <CLIENT-2> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:5C
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x007F (127)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x795F (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x30CE (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1276741955 (0x4C198943)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:5C
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xF48A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1276741955 (0x4C198943)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-2> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:5C
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0080 (128)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7952 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x7E0F (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1276741955 (0x4C198943)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.161
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:5C
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xF18A (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1276741955 (0x4C198943)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-2> successfully transited to INIT-REBOOT state

DHCP Client <CLIENT-2> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
- Message Option containing:
  - Type field set to DHCP_REQUESTED_IP_ADDRESS_OPTION     (Requested IP Address) 
  - Value set to <CLIENT1-IP-ADDRESS> (30.1.1.160) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:5C
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x0081 (129)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7957 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 258 
UDP: Checksum         = 0x5658 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1357777715 (0x50EE0B33)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPNAK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5AA0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xC5D7 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1357777715 (0x50EE0B33)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5C
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 56 (Message) ---
DHCP: Length                   = 16
DHCP: Value                    = Invalid address
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-2> received expected DHCPNAK Message from <DIface-0>

Destination IP Address field in received DHCPNAK Message is correctly set to 255.255.255.255

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:5a
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:58:01 

IP Address   : 30.1.1.161
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:5c
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:58:01 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:5a
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:58:01 

IP Address   : 30.1.1.161
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:5c
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:58:01 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:5A for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:5A 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:5C for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:5C 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-13.2: Passed

>> DHCP-SERVER-13.3
TEST_DESCRIPTION
If 'giaddr' is set in the DHCPREQUEST message, the client is on a
different subnet.  The server MUST set the broadcast bit in the
DHCPNAK, so that the relay agent will broadcast the DHCPNAK to the
client
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Configure DUT to add static route for network
        <RELAY-AGENT1-IP-POOL-SUBNET>
        (mask <RELAY-AGENT1-IP-POOL-SUBNETMASK>) using gateway
         <AIface-0-IP-ADDRESS> through <DIface-0>
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <RELAY-AGENT1-IP-POOL-START>
       - End of pool as <RELAY-AGENT1-IP-POOL-END>
       - Subnet as <RELAY-AGENT1-IP-POOL-SUBNET>
       - Subnet Mask as <RELAY-AGENT1-IP-POOL-SUBNETMASK>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to INIT-REBOOT
        state
- ANVL: Initialize a DHCP Relay Agent working between ANVL and DUT
        indicating client1 is in a different subnet than any of DUT
        interfaces, so all DHCP Messages sent by emulated client(s)
        will have non-zero 'giaddr' field value
- ANVL:DHCP Client <CLIENT-1> Sends DHCPREQUEST Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPNAK Message
- ANVL: Verify that received DHCPNAK Message contains:
        - Bit 1  of 'flags' field  is set to  1
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-5


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:5D for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:5D 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 5
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |       .........+..........................+                |
  |       .        |<AIface-0>      <DIface-0>|                |
  |<RELAY-AGENT1>  |                          |           DUT  |
  +-------+--------+                          +----------------+
          .N1
          .
<AIface-0>.N1
  +-------+--------+
  |                |
  |                |
  |                |
  |                |
  | <CLIENT-1>     |
  +----------------+


Causing DUT to add a static route on DUT for
Destination Address 62.0.0.0
Gateway Address 30.1.1.150
outgoing interface <DIface-0>
Netmask 255.255.255.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
62.0.0.0 30.1.1.150 0 255.255.255.0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/ip-dut-static-route-add-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route add -net -netmask 255.255.255.0 62.0.0.0 30.1.1.150
    add net 62.0.0.0: netmask 255.255.255.0: gateway 30.1.1.150
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       6     gei0   0    
30.1.1.5                        30.1.1.5                      UH       5     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
62.0.0.0/24                     30.1.1.150                    UGS      0     gei0   0    
localhost                       localhost                     UH       3112  lo0    0    
128.224.166.0/23                vxTarget                      UC       4006  gei2   0    
vxTarget                        vxTarget                      UH       23435 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       819616lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 62.0.0.11
End IP Address   : 62.0.0.21
Subnet           : 62.0.0.0
Subnet Mask      : 255.255.255.0
for <DIface-2>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2 62.0.0.0 255.255.255.0 62.0.0.11 62.0.0.21 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:62.0.0.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:62.0.0.11
POOL_RANGE_END:62.0.0.21
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 62.0.0.0 255.255.255.0

-> cmd dhcps pool add 62.0.0.0 62.0.0.11 62.0.0.21

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 62.0.0.0        netmask: 255.255.255.0  
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:5D
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0082 (130)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x795C (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x08CF (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 530505148 (0x1F9EDDBC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5D
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:5D
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xCC8D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 530505148 (0x1F9EDDBC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5D
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:5D
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0083 (131)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x794F (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x5710 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 530505148 (0x1F9EDDBC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5D
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:5D
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xC98D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 530505148 (0x1F9EDDBC)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5D
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to INIT-REBOOT state
Initializing a DHCP Relay Agent working between ANVL and DUT
indicating client1 is in a different subnet than any of DUT
interfaces, so all DHCP Messages sent by emulated client(s)
will have non-zero 'giaddr' field value

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x0084 (132)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7954 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 258 
UDP: Checksum         = 0xB336 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 1
DHCP: xid                       = 1916992337 (0x7242FB51)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 62.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:5D
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPNAK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x6B1C (27420)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0xB182 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 62.0.0.1
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 308 
UDP: Checksum         = 0xB861 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1916992337 (0x7242FB51)
DHCP: secs                      = 0
DHCP: flags                     = 0x8000 (BROADCAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 62.0.0.1
DHCP: chaddr                    = 02:02:00:00:00:5D
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 56 (Message) ---
DHCP: Length                   = 16
DHCP: Value                    = Invalid address
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPNAK Message from <DIface-0>

Received DHCPNAK Message correctly contains:
- Bit 1  of 'flags' field correctly set to 1

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 62.0.0.11
End IP Address   : 62.0.0.21
Subnet           : 62.0.0.0
Subnet Mask      : 255.255.255.0
for <DIface-2>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
2 62.0.0.0 255.255.255.0 62.0.0.11 62.0.0.21 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:62.0.0.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:62.0.0.11
POOL_RANGE_END:62.0.0.21
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:5d
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:58:24 

-> cmd dhcps pool delete 62.0.0.0 62.0.0.11 62.0.0.21

-> cmd dhcps subnet delete 62.0.0.0

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:5d
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:58:24 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:5d
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:58:24 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: active
Bound to     :
          MAC: 02:02:00:00:00:5d
Lease time   : 200 seconds
Expires at   : 1970/01/01 05:58:24 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Causing DUT to delete static route on DUT for
Destination Address 62.0.0.0
Gateway Address 30.1.1.150
outgoing interface <DIface-0>
Netmask 255.255.255.0
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
62.0.0.0 30.1.1.150 0 255.255.255.0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/ip-dut-static-route-delete-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd route delete -net 62.0.0.0
    delete net 62.0.0.0
-> cmd route show

INET route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
30.1.1.0/24                     30.1.1.5                      UC       6     gei0   0    
30.1.1.5                        30.1.1.5                      UH       5     lo0    0    
40.1.1.0/24                     40.1.1.5                      UC       1     gei1   0    
40.1.1.5                        40.1.1.5                      UH       0     lo0    0    
localhost                       localhost                     UH       3112  lo0    0    
128.224.166.0/23                vxTarget                      UC       4011  gei2   0    
vxTarget                        vxTarget                      UH       23603 lo0    0    

INET6 route table - vr: 0, table: 254
Destination                     Gateway                       Flags    Use   If    Metric
::1                             ::1                           UH       825836lo0    0    
fe80::%lo0/64                   fe80::1%lo0                   UC       6     lo0    0    
fe80::%gei2/64                  fe80::225:90ff:fe04:e2de%gei2 UC       35    gei2   0    
fe80::%gei0/64                  fe80::215:17ff:fec8:9028%gei0 UC       0     gei0   0    
fe80::%gei1/64                  fe80::215:17ff:fec8:9029%gei1 UC       0     gei1   0    
fe80::1%lo0                     fe80::1%lo0                   UH       0     lo0    0    
fe80::215:17ff:fec8:9028%gei0   fe80::215:17ff:fec8:9028%gei0 UH       0     lo0    0    
fe80::215:17ff:fec8:9029%gei1   fe80::215:17ff:fec8:9029%gei1 UH       0     lo0    0    
fe80::225:90ff:fe04:e2de%gei2   fe80::225:90ff:fe04:e2de%gei2 UH       0     lo0    0    

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:5D for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:5D 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-13.3: Passed

>> DHCP-SERVER-13.4
TEST_DESCRIPTION
o DHCPREQUEST generated during REBINDING state:
  The DHCP server SHOULD check 'ciaddr' for correctness before replying
  to the DHCPREQUEST
TEST_REFERENCE
RFC 2131 Section 4.3.2 Page 32 'DHCPREQUEST message'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: Wait till (<CLIENT1-REBINDING-TIME>+<ParamToleranceTime>)
        for Rebinding Time (T2) of <CLIENT-1> to expire
- ANVL:DHCP Client <CLIENT-1> Sends DHCPREQUEST Message to DUT
       through <DIface-0> containing :
        - 'ciaddr' field set to 0
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Does not send DHCPACK Message
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:5E for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:5E 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:5E
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0085 (133)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7959 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xF6DA (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 535228263 (0x1FE6EF67)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:5E
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xBA99 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 535228263 (0x1FE6EF67)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:5E
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0086 (134)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x794C (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x451C (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 535228263 (0x1FE6EF67)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:5E
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xB799 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 535228263 (0x1FE6EF67)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

Waiting (up to 177.000 seconds) for Rebinding Time (T2) of <CLIENT-1> to expire

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT through <DIface-0> containing :
  - 'ciaddr' field set to 0 (0.0.0.0) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:5E
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0087 (135)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x59B6 (Correct)
IP: Source Address         = 30.1.1.160
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xD539 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 535228263 (0x1FE6EF67)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for no DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x5AA0 (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x12A9 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 535228263 (0x1FE6EF67)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5E
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 6 (DHCPNAK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 56 (Message) ---
DHCP: Length                   = 16
DHCP: Value                    = Invalid address
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> ignoring DHCPNAK Message from <DIface-0>

DHCP Client <CLIENT-1> correctly did not receive DHCPACK Message from <DIface-0>

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:5E for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:5E 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-13.4: Passed

>> DHCP-SERVER-14.1
TEST_DESCRIPTION
If the server receives a DHCPDECLINE message,...
The server MUST mark the network address as not available
TEST_REFERENCE
RFC 2131 Section 4.3.3 Page 33 'DHCPDECLINE message'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: Extracts the content of 'yiaddr' field to <extractedYiaddr>
- ANVL: DHCP Client <CLIENT-1> sends DHCPDECLINE Message to DUT
        through <DIface-0>
- ANVL: Wait till <ParamProcessTime> for DUT to process the
        DHCPDECLINE message
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Verify that received DHCPOFFER Message contains:
        - 'yiaddr' field is not set to extractedYiaddr
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:5F for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:5F 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:5F
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0088 (136)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7956 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x5BA3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1425364367 (0x54F5558F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5F
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:5F
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x1F62 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1425364367 (0x54F5558F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5F
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:5F
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x0089 (137)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7949 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0xA9E4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1425364367 (0x54F5558F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5F
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:5F
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x1C62 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1425364367 (0x54F5558F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5F
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

Extracted the content of 'yiaddr' field (30.1.1.160) to <extractedYiaddr>

DHCP Client <CLIENT-1> sending DHCPDECLINE Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:5F
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x008A (138)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7948 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x28E4 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1425364367 (0x54F5558F)
DHCP: secs                      = 0
DHCP: flags                     = 0x8000 (BROADCAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5F
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 4 (DHCPDECLINE)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Waiting (up to 2.000 seconds) for DUT to process the DHCPDECLINE message

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:5F
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x008B (139)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7953 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x5BA3 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1425364367 (0x54F5558F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5F
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:5F
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFE (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.161
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x1F60 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1425364367 (0x54F5558F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.161
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:5F
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

'yiaddr' field in received DHCPOFFER Message is correctly set to 30.1.1.161 (not set to 30.1.1.160)

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:5F for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:5F 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-14.1: Passed

>> DHCP-SERVER-15.2
TEST_DESCRIPTION
Upon receipt of a DHCPRELEASE message, ... The server SHOULD retain a
 record of
the client's initialization parameters for possible reuse in response to
subsequent requests from the client
TEST_REFERENCE
RFC 2131 Section 4.3.4 Page 33 'DHCPRELEASE message'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL: DHCP Client <CLIENT-1> transit state machine to BOUND state
- ANVL: Extracts the content of 'yiaddr' field to <extractedYiaddr>
- ANVL: Wait till <ParamProcessTime> for DUT to complete the
        activation of DHCP session
- ANVL: DHCP Client <CLIENT-1> sends DHCPRELEASE Message to DUT
        through <DIface-0>
- ANVL: Wait till <ParamProcessTime> for DUT to process the
        DHCPRELEASE Message
- ANVL:DHCP Client <CLIENT-1> Sends DHCPDISCOVER Message to DUT
       through <DIface-0>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPOFFER Message
- ANVL: Verify that received DHCPOFFER Message contains:
        - 'yiaddr' field is set to extractedYiaddr
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:60 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:60 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:60
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x008C (140)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7952 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xF6D2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 783736989 (0x2EB6E09D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:60
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:60
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xBA91 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 783736989 (0x2EB6E09D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:60
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPOFFER Message from DUT

DHCP Client <CLIENT-1> sending DHCPREQUEST Message to DUT

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:60
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 284 bytes
IP: Identification         = 0x008D (141)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x7945 (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 264 
UDP: Checksum         = 0x4514 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 783736989 (0x2EB6E09D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:60
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 3 (DHCPREQUEST)
DHCP: --- Option 50 (Requested IP Address) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.160
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:60
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xB791 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 783736989 (0x2EB6E09D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:60
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


Received DHCPACK Message from DUT

DHCP Client <CLIENT-1> successfully transited to BOUND state

Extracted the content of 'yiaddr' field (30.1.1.160) to <extractedYiaddr>

Waiting (up to 2.000 seconds) for DUT to complete the activation of DHCP session

DHCP Client <CLIENT-1> sending DHCPRELEASE Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:15:17:C8:90:28
ETHER: Source      = 02:02:00:00:00:60
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 278 bytes
IP: Identification         = 0x008E (142)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AA3 (Correct)
IP: Source Address         = 30.1.1.160
IP: Destination Address    = 30.1.1.5
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 258 
UDP: Checksum         = 0x8829 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 783736989 (0x2EB6E09D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.160
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:60
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 7 (DHCPRELEASE)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 255 (End Option) ---


Waiting (up to 2.000 seconds) for DUT to process the DHCPRELEASE Message

DHCP Client <CLIENT-1> sending DHCPDISCOVER Message to DUT through <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:60
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x008F (143)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x794F (Correct)
IP: Source Address         = 0.0.0.0
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xF6D2 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 783736989 (0x2EB6E09D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:60
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 1 (DHCPDISCOVER)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPOFFER Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 02:02:00:00:00:60
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x0000 (0)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x3AFF (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.160
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0xBA91 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 783736989 (0x2EB6E09D)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 0.0.0.0
DHCP: yiaddr                    = 30.1.1.160
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:60
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 2 (DHCPOFFER)
DHCP: --- Option 51 (IP Address Lease Time) ---
DHCP: Length                   = 4
DHCP: Value                    = 200 seconds (3 minutes 20 seconds)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPOFFER Message from <DIface-0>

'yiaddr' field in received DHCPOFFER Message is correctly set to 30.1.1.160

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:60
Lease time   : 200 seconds
Expires at   : 1970/01/01 06:02:37 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

IP Address   : 30.1.1.160
Binding state: offered
Bound to     :
          MAC: 02:02:00:00:00:60
Lease time   : 200 seconds
Expires at   : 1970/01/01 06:02:37 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:60 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:60 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> exit
Au revoir!
Connection closed by foreign host.

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-15.2: Passed

>> DHCP-SERVER-16.1
TEST_DESCRIPTION
The server responds to a DHCPINFORM message by sending a DHCPACK
message directly to the address given in the 'ciaddr' field of the
DHCPINFORM message
TEST_REFERENCE
RFC 2131 Section 4.3.5 Page 33 'DHCPINFORM message'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPINFORM Message to DUT
       through <DIface-0> containing :
        - Source IP Address field set to <AIface-0-IP-ADDRESS>
        - 'ciaddr' field set to <AIface-0-IP-ADDRESS>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPACK Message
- ANVL: Verify that received DHCPACK Message contains:
        - Destination IP Address field is set to <AIface-0-IP-ADDRESS>
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:61 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:61 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPINFORM Message to DUT through <DIface-0> containing :
  - Source IP Address field set to <AIface-0-IP-ADDRESS>     (30.1.1.150) 
  - 'ciaddr' field set to <AIface-0-IP-ADDRESS> (30.1.1.150) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:61
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0090 (144)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x59B7 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0xA7E0 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1444725242 (0x561CC1FA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.150
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:61
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x288E (10382)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x127B (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x7B15 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1444725242 (0x561CC1FA)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.150
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:61
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPACK Message from <DIface-0>

Destination IP Address field in received DHCPACK Message is correctly set to 30.1.1.150

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:61 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:61 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0

failed :: not found
-> cmd dhcps subnet delete 40.1.1.0

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-16.1: Passed

>> DHCP-SERVER-16.2
TEST_DESCRIPTION
The server responds to a DHCPINFORM message by sending a DHCPACK ...
The server MUST NOT send a lease expiration time to the client
TEST_REFERENCE
RFC 2131 Section 4.3.5 Page 33 'DHCPINFORM message'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPINFORM Message to DUT
       through <DIface-0> containing :
        - Source IP Address field set to <AIface-0-IP-ADDRESS>
        - 'ciaddr' field set to <AIface-0-IP-ADDRESS>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPACK Message
- ANVL: Verify that received DHCPACK Message contains:
        - Message Option containing:
          - Type field is not set to 51 (IP Address Lease Time Option)
TEST_CLASSIFICATION
MUST
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:62 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:62 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPINFORM Message to DUT through <DIface-0> containing :
  - Source IP Address field set to <AIface-0-IP-ADDRESS>     (30.1.1.150) 
  - 'ciaddr' field set to <AIface-0-IP-ADDRESS> (30.1.1.150) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:62
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0091 (145)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x59B6 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x6636 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 189877871 (0x0B514E6F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.150
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:62
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x288F (10383)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x127A (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x396B (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 189877871 (0x0B514E6F)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.150
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:62
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPACK Message from <DIface-0>

Message Option in received DHCPACK Message correctly does not contain Option IP Address Lease Time (51) 

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:62 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:62 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-16.2: Passed

>> DHCP-SERVER-16.3
TEST_DESCRIPTION
The server responds to a DHCPINFORM message by sending a DHCPACK ...
SHOULD NOT fill in 'yiaddr'
TEST_REFERENCE
RFC 2131 Section 4.3.5 Page 33 'DHCPINFORM message'
TEST_METHOD
 SETUP: Configure IP Address pool on the DUT for interface <DIface-0>
        as follows :
       - Start of pool as <DUT-SERVER-0-IP-POOL-START>
       - End of pool as <DUT-SERVER-0-IP-POOL-END>
       - Subnet as <DUT-SERVER-0-IP-POOL-SUBNET>
       - Subnet Mask as <DUT-SERVER-0-IP-POOL-SUBNETMASK>
 SETUP: Configure Lease Time of <ParamLeaseTime> on DUT
        for interface <DIface-0>
 SETUP: Configure DHCP Server on the DUT to start
        listening on 1 interface(s)
- ANVL:DHCP Client <CLIENT-1> Sends DHCPINFORM Message to DUT
       through <DIface-0> containing :
        - Source IP Address field set to <AIface-0-IP-ADDRESS>
        - 'ciaddr' field set to <AIface-0-IP-ADDRESS>
- ANVL:DHCP Client <CLIENT-1> Listens (upto <ParamListenTime>) on
       <DIface-0>
-  DUT: Sends DHCPACK Message
- ANVL: Verify that received DHCPACK Message contains:
        - 'yiaddr' field is set to 0
TEST_CLASSIFICATION
SHOULD
TEST_TOPOLOGY
TOPOLOGY-1


Configuring DHCP Server on DUT only to allow client identified
by hardware address 02:02:00:00:00:63 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:63 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

  DHCP Server topology # 1
  ---------------------------------------

  +----------------+                          +----------------+
  |                |                          |                |
  |                |N0                      N0|                |
  |                +--------------------------+                |
  |                |<AIface-0>      <DIface-0>|                |
  | <CLIENT-1>     |                          |           DUT  |
  +----------------+                          +----------------+


Configuring DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps subnet add 30.1.1.0 255.255.255.0

-> cmd dhcps pool add 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Configuring all Lease Time related items for DHCP Server
running on the DUT to 200 for clients connected through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "200"

-> cmd dhcps config set 40.1.1.0 default-lease-time "200"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Starting DHCP server to listen on all 1
DUT interface(s)
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
1

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-start-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps interface enable gei0

-> cmd dhcps interface enable gei1

-> cmd sysvar set -c -o ipdhcps.in_offered_state_max_time "100"
sysvar: ipdhcps.in_offered_state_max_time=100 ok
-> cmd sysvar get ipdhcps.in_offered_state_max_time
sysvar: ipdhcps.in_offered_state_max_time=100
-> cmd dhcps subnet list

     Subnet: default         
     Subnet: 30.1.1.0        netmask: 255.255.255.0  

-> cmd dhcps pool list 30.1.1.0
     Pool: 30.1.1.160      ->  30.1.1.210     (51 entries) 


-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

DHCP Client <CLIENT-1> sending DHCPINFORM Message to DUT through <DIface-0> containing :
  - Source IP Address field set to <AIface-0-IP-ADDRESS>     (30.1.1.150) 
  - 'ciaddr' field set to <AIface-0-IP-ADDRESS> (30.1.1.150) 

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 02:02:00:00:00:63
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 272 bytes
IP: Identification         = 0x0092 (146)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x59B5 (Correct)
IP: Source Address         = 30.1.1.150
IP: Destination Address    = 255.255.255.255
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 68 (dhcp client)
UDP: Destination Port = 67 (dhcp server)
UDP: Length           = 252 
UDP: Checksum         = 0x691D (Correct)
UDP:
DHCP:  ----   DHCP Bootp Request Packet  ----
DHCP:
DHCP: op                        = 1 (Boot Request)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1842211082 (0x6DCDE90A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.150
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:63
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 8 (DHCPINFORM)
DHCP: --- Option 255 (End Option) ---


Listening (up to 202.000 seconds) for DHCPACK Message on <DIface-0>

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0800 (DOD IP)
ETHER:
IP: ---- IP Packet ----
IP:
IP: Version                = 4
IP: Internet Header Length = 5 (20 bytes)
IP: Type Of Service        = 0x00
IP:  |01234567
IP:  |000.....             = Precedence (Routine)
IP:  |...0....             = Normal Delay
IP:  |....0...             = Normal Throughput
IP:  |.....0..             = Normal Reliability
IP:  |......0.             = Normal Monetary Cost
IP:  |.......0             = Must Be Zero 
IP: Total Length           = 328 bytes
IP: Identification         = 0x14ED (5357)
IP: Flags                  = 0
IP:  |012
IP:  |0..                  = Reserved 
IP:  |.0.                  = May Fragment
IP:  |..0                  = Last Fragment
IP: Fragment Offset        = 0x0000 (0 bytes)
IP: Time to Live           = 64
IP: Protocol               = UDP (17)
IP: Header Checksum        = 0x261C (Correct)
IP: Source Address         = 30.1.1.5
IP: Destination Address    = 30.1.1.150
IP:
UDP: ---- UDP Packet ----
UDP:
UDP: Source Port      = 67 (dhcp server)
UDP: Destination Port = 68 (dhcp client)
UDP: Length           = 308 
UDP: Checksum         = 0x3C52 (Correct)
UDP:
DHCP:  ----   DHCP Bootp Response Packet  ----
DHCP:
DHCP: op                        = 2 (Boot Reply)
DHCP: htype                     = 1 (Ethernet (10Mb))
DHCP: hlen                      = 6
DHCP: hops                      = 0
DHCP: xid                       = 1842211082 (0x6DCDE90A)
DHCP: secs                      = 0
DHCP: flags                     = 0x0000 (UNICAST)
DHCP: ciaddr                    = 30.1.1.150
DHCP: yiaddr                    = 0.0.0.0
DHCP: siaddr                    = 0.0.0.0
DHCP: giaddr                    = 0.0.0.0
DHCP: chaddr                    = 02:02:00:00:00:63
DHCP: Server Host Name          = Unspecified
DHCP: Boot File Name            = Unspecified
DHCP: Magic Cookie              = 99 130 83 99 ([ OK ])
DHCP:
DHCP: --- Option 53 (Message Type) ---
DHCP: Length                   = 1
DHCP: Value                    = 5 (DHCPACK)
DHCP: --- Option 54 (Server Identifier) ---
DHCP: Length                   = 4
DHCP: Value                    = 30.1.1.5
DHCP: --- Option 1 (Subnet Mask) ---
DHCP: Length                   = 4
DHCP: Value                    = 255.255.255.0
DHCP: --- Option 255 (End Option) ---


DHCP Client <CLIENT-1> received expected DHCPACK Message from <DIface-0>

'yiaddr' field in received DHCPACK Message is correctly set to 0.0.0.0

Resetting all Lease Time related items for DHCP Server
running on the DUT and set to a default of 200 for clients connected
through <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 200 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-lease-time-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps config set 30.1.1.0 default-lease-time "864000"

-> cmd dhcps config set 40.1.1.0 default-lease-time "864000"

failed :: not found
-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP Server with IP Address pool as defined below:
Start IP Address : 30.1.1.160
End IP Address   : 30.1.1.210
Subnet           : 30.1.1.0
Subnet Mask      : 255.255.255.0
for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 30.1.1.0 255.255.255.0 30.1.1.160 30.1.1.210 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-ip-pool-configure-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
POOL_SUBNET:30.1.1.0
POOL_SUBNET_MASK:255.255.255.0
POOL_RANGE_START:30.1.1.160
POOL_RANGE_END:30.1.1.210
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps lease list 

-> cmd dhcps pool delete 30.1.1.0 30.1.1.160 30.1.1.210

-> cmd dhcps subnet delete 30.1.1.0

-> cmd dhcps lease list 

-> exit
Au revoir!
Connection closed by foreign host.

Resetting configuration(s) on DUT to allow only client
by hardware address 02:02:00:00:00:63 for <DIface-0>
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:
0 02:02:00:00:00:63 0

SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-allow-this-client-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> exit
Au revoir!
Connection closed by foreign host.

Resetting DHCP server running on the DUT
ANVL_DUTHOSTNAME:
128.224.166.238

ANVL_PARAMARG:


SCRIPT_MODE:
FOREGROUND

Executing system command:
  "./DocScriptQ35/DHCP-SERVER/dhcp-server-reset-command.exp $ANVL_DUTHOSTNAME $ANVL_PARAMARG"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd dhcps subnet delete 30.1.1.0
exit

failed :: not found
-> 
ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BA
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BA
ARP: Source Protocol Address      = 30.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 30.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BA
ETHER: Source      = 00:15:17:C8:90:28
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:28
ARP: Source Protocol Address      = 30.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BA
ARP: Destination Protocol Address = 30.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:28

ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = FF:FF:FF:FF:FF:FF
ETHER: Source      = 00:1B:21:7D:57:BB
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Request (0x0001)
ARP: Source Hardware Address      = 00:1B:21:7D:57:BB
ARP: Source Protocol Address      = 40.1.1.150
ARP: Destination Hardware Address = 00:00:00:00:00:00
ARP: Destination Protocol Address = 40.1.1.5
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---


ETHER: ---- Ethernet Header ----
ETHER:
ETHER: Destination = 00:1B:21:7D:57:BB
ETHER: Source      = 00:15:17:C8:90:29
ETHER: Type        = 0x0806 (ARP)
ETHER:
ARP: ---- ARP Packet ----
ARP:
ARP: Hardware Type                = Ethernet (0x0001)
ARP: Protocol Type                = DOD IP (0x0800)
ARP: Hardware Address Length      = 6
ARP: Protocol Address Length      = 4
ARP: Function                     = Response (0x0002)
ARP: Source Hardware Address      = 00:15:17:C8:90:29
ARP: Source Protocol Address      = 40.1.1.5
ARP: Destination Hardware Address = 00:1B:21:7D:57:BB
ARP: Destination Protocol Address = 40.1.1.150
ARP:
ARP: ---- End ARP Packet ----
ARP:
ETHER: --- Padding [18 bytes] ---
ETHER:  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
ETHER:  00 00                                             ..
ETHER: --- Padding End ---

IP DUT is still alive at: 00:15:17:C8:90:29
<< DHCP-SERVER-16.3: Passed
Executing system command:
  "./DocScriptQ35/DHCP-SERVER/DHCPSpostsuite.exp $ANVL_DUTHOSTNAME"
spawn telnet 128.224.166.238
Trying 128.224.166.238...
Connected to 128.224.166.238.
Escape character is '^]'.

-> cmd ipd kill ipdhcps
ipd: kill ipdhcps ok
-> ipDetach 0,"gei"
value = 0 = 0x0
-> ipDetach 1,"gei"
value = 0 = 0x0
-> exit
Au revoir!
Connection closed by foreign host.

Number of tests run:          61
Number of tests passed:       61
Number of tests failed:       0
Number of tests inconclusive: 0
